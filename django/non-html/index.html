<!DOCTYPE html>
<html dir="rtl" lang="fa">


<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43783552-5"></script>
<script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config','UA-43783552-5');</script>
<link rel="canonical" href="https://oruji.github.io/django/non-html/" />
<link rel="shortcut icon" href="https://oruji.github.io/static/img/favicon.ico" />
<title>تولید محتوای غیر html جنگو Django کتاب آموزش چارچوب فریم ورک</title>
<meta name="description" content="در این کتاب آموزش برخط آنلاین چارچوب فریم ورک جنگو Django استفاده جنگو برای تولید انواع دیگر محتویات به غیر از HTML از جمله CSV و PDF و Feed و RSS خواهیم پرداخت" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index, follow" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="fontiran.com:license" content="ZM3QX" />
<meta name="msvalidate.01" content="338AFFB8975A4C65F4A4BC10CDAFF254" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@oruji" />
<meta name="twitter:creator" content="@oruji" />
<meta name="twitter:title" content="تولید محتوای غیر html جنگو Django کتاب آموزش چارچوب فریم ورک">
<meta name="twitter:description" content="در این کتاب آموزش برخط آنلاین چارچوب فریم ورک جنگو Django استفاده جنگو برای تولید انواع دیگر محتویات به غیر از HTML از جمله CSV و PDF و Feed و RSS خواهیم پرداخت">
<meta name="twitter:image" content="https://oruji.github.io/django/non-html/logo.png" />
<meta property="og:title" content="تولید محتوای غیر html جنگو Django کتاب آموزش چارچوب فریم ورک" />
<meta property="og:description" content="در این کتاب آموزش برخط آنلاین چارچوب فریم ورک جنگو Django استفاده جنگو برای تولید انواع دیگر محتویات به غیر از HTML از جمله CSV و PDF و Feed و RSS خواهیم پرداخت" />
<meta property="og:url" content="https://oruji.github.io/django/non-html/" />
<meta property="og:type" content="article" />
<meta property="og:image" content="https://oruji.github.io/django/non-html/logo.png" />
<script src="https://oruji.github.io/static/js/main.js"></script>
<style>
.token.bold,.token.important,.token.string{font-weight:700}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:20px;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#e7eeff}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.doctype,.token.prolog{color:#708090}.token.comment{color:#008a32}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.symbol{color:#000}.token.attr-name,.token.char,.token.inserted,.token.selector{color:#690}.token.builtin{color:#000}.token.string{color:#0f69ff}.language-css .token.string,.style .token.string,.token.entity,.token.url{color:#a67f59}.token.operator{color:#692d02}.token.atrule,.token.attr-value,.token.keyword{color:maroon;font-weight:700}.token.function{color:#000}.token.important,.token.regex{color:#e90}.token.variable{color:#b98118}.token.italic{font-style:italic}.token.entity{cursor:help}
</style>
<script src="https://oruji.github.io/static/js/prism.js"></script>
<style>
textarea, input, button, select { font-family: inherit; font-size: inherit;} p, li { text-align: justify;} main, nav { width: 100%;} .leftBlock, .leftInline, .logout, pre, canvas { direction: ltr;} .note td, pre { word-wrap: break-word;} body, main, div, footer, h1, h2, h3, h4, h5, h6, header, nav, input, button { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0; padding: 0 } body { font-family: IRANSans; background-color: #fff; font-size: 1em; line-height: 35px;} nav { font-size: 0.83em; padding: 14px; float: right; margin-bottom: 2px;} header { color: #fff; margin: 2px; min-height: 86px; padding: 13px;} footer { font-size: 0.83em; text-align: center; padding: 30px; clear: both; color: #fff; margin: 2px;} pre { text-align: left; font-family: consolas, "Courier New", Courier, mono, serif; font-size: 0.86em; background-color: #e7eeff; padding: 8px 10px 8px 8px; color: #000; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; line-height: 20px; border-radius: 5px } code { direction: ltr; text-align: left; font-family: consolas, "Courier New", Courier, mono, serif; font-size: 0.92em; background-color: #e7eeff; padding: 10px !important; margin: 10px !important; color: #000; white-space: pre !important; white-space: -moz-pre-wrap !important; white-space: -pre-wrap !important; white-space: -o-pre-wrap !important; line-height: 20px; border-radius: 5px; display: block; overflow: auto; word-wrap: break-word;} .code { direction: ltr; text-align: left; font-family: consolas, "Courier New", Courier, mono, serif; font-size: 0.92em; background-color: #e7eeff; padding: 10px !important; margin: 10px !important; color: #000; white-space: pre !important; white-space: -moz-pre-wrap !important; white-space: -pre-wrap !important; white-space: -o-pre-wrap !important; line-height: 20px; border-radius: 5px; display: block; overflow: auto; word-wrap: break-word;} h1, h2, h3, h4, h5, h6 { font-weight: 500 !important } button { padding: 4px; border-radius: 5px;} .titr-link { text-align: center; font-weight: 700;} h1 { margin-bottom: 20px; margin-top: 20px; font-size: 1.5em;} h2 { font-size: 1.33em;} h3 { font-size: 1.17em;} h4 { font-size: 1.08em;} h5 { font-size: 1em;} textarea { height: 150px; font-size: inherit; line-height: 20px; width: 98%;} main { border-radius: 7px; background-color: #fff; padding-top: 15px; padding-bottom: 15px; padding-right: 20px; padding-left: 20px; min-height: 500px; box-shadow: 0 0 3px 1px #e0d9ff; float: right;} .logout { height: 40px; border-radius: 5px; color: #fff; margin: -5px 2px 2px; direction: ltr; padding-right: 10px; float: left;} .myClean { padding: 0; margin: 0;} .myscroll { display: block; overflow-x: auto } li { padding: 5px } .gradient { border-radius: 7px; background: linear-gradient(#001F38, #37627a); background: -moz-linear-gradient(#001F38, #37627a); background: -webkit-linear-gradient(#001F38, #37627a); background: -ms-linear-gradient(#001F38, #37627a); background: -o-linear-gradient(#001F38, #37627a) } .puzzle { white-space: nowrap;} a { color: #add8e6;} a.content { color: #4164ca;} .last-line, .titr-link { margin-bottom: 10px;} .titr-link { background-color: #e8eeff; border-radius: 5px;} .index, .index-style { border-radius: 4px; padding: 20px; display: block;} .index:hover { color: #add8e6; background-color: #366179;} .index-style { background-color: #e7eeff;} .index-style:hover { color: #add8e6; background-color: #366179;} .myTitle { margin-bottom: -10px } .anav, .anav:hover, .divnav { padding: 4px; display: block;} .divnav { color: #e7eeff; background-color: #366179; border-radius: 3px;} .anav { color: #add8e6;} .anav:hover { background-color: #3e6c8a; border-radius: 3px;} .myError { margin-bottom: 10px; margin-top: 5px; color: red;} .alogo { padding: 10.5px; float: right; color: #000; text-align: center; width: 150px;} .alogo:hover { padding: 10px; border-style: solid; border-radius: 10px; border-width: .5px;} .puzzle, ol, p, li { display: block; overflow-x: auto;} .leftBlock { text-align: left;} .radius5 { border-radius: 5px;} hr { margin-bottom: 15px; margin-top: 0;} .change-lang { margin-top: 5px; background-color: #e8eeff; color: #000; padding-right: 10px; padding-left: 10px; border-radius: 3px; line-height: 29px; text-align: center; height: 26px; display: block; padding-bottom: 5px;} .note { margin: 1em 0; width: 100%; overflow: hidden; background: #FFF; border-radius: 10px; border: 1px solid #167F92 } .note tr { border: 1px solid #D9E4E6 } .note tr:nth-child(odd) { background-color: #e0e0e0 } .note th { border: 1px solid #FFF; background-color: #167F92; color: #FFF } .note th:first-child { display: table-cell; text-align: center } .note th:nth-child(2) { display: table-cell } .note th:nth-child(2) span { display: block } .note th:nth-child(2):after { display: none } .note td { max-width: 7em; border: 1px solid #D9E4E6 } .note td:first-child { display: table-cell; text-align: center; border-right: 1px solid #D9E4E6 } .note td, .note th { display: table-cell; padding: 1em } a, ul.social-icons li a:hover { text-decoration: none } ul.social-icons { padding: 0; width: auto; overflow: initial; margin-top: 0; margin-bottom: 0; float: left;} ul.social-icons li { background-image: url(https://oruji.github.io/static/img/social-sprites.svg); background-repeat: no-repeat; background-color: #FFF; background-position: 0 100px; display: inline-block; margin: -1px 1px 5px 0; padding: 0; border-radius: 100%; overflow: visible; transition: all .3s ease; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .42); -moz-border-radius: 100%; -moz-transition: all .3s ease; -ms-transition: all .3s ease; -o-transition: all .3s ease; -webkit-border-radius: 100%; -webkit-transition: all .3s ease; border: 1.5px solid #12354d; margin-left: 3px; margin-right: 3px;} ul.social-icons li a { display: block; height: 28px; width: 28px; text-align: center } ul.social-icons li[class] a { text-indent: -9999px } ul.social-icons li a i[class^=icon-] { color: #444; font-style: 16px; position: relative; top: 3px } ul.social-icons li a:active { box-shadow: inset 0 0 10px rgba(0, 0, 0, .3), inset 0 0 10pxrgba(0, 0, 0, .3); -moz-box-shadow: inset 0 0 10px rgba(0, 0, 0, .3), inset 0 0 10pxrgba(0, 0, 0, .3); -webkit-box-shadow: inset 0 0 10px rgba(0, 0, 0, .3), inset 0 0 10pxrgba(0, 0, 0, .3) } ul.social-icons li a:active, ul.social-icons li:active { border-radius: 100%; -moz-border-radius: 100%; -webkit-border-radius: 100% } ul.social-icons li.facebook { background-position: 0 -001px } ul.social-icons li.facebook:hover { background-position: 0 -031px } ul.social-icons li.github { background-position: 0 -061px } ul.social-icons li.github:hover { background-position: 0 -091px } ul.social-icons li.rss { background-position: 0 -121px } ul.social-icons li.rss:hover { background-position: 0 -151px } ul.social-icons li.twitter { background-position: 0 -181px } ul.social-icons li.twitter:hover { background-position: 0 -211px } ul.social-icons li.googleplus { background-position: 0 -301px } ul.social-icons li.googleplus:hover { background-position: 0 -331px } ul.social-icons li.linkedin { background-position: 0 -241px } ul.social-icons li.linkedin:hover { background-position: 0 -271px } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 900; src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Black.eot); src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Black.eot?#iefix) format('embedded-opentype'), url(https://oruji.github.io/static/font/woff2/IRANSansWeb_Black.woff2) format('woff2'), url(https://oruji.github.io/static/font/woff/IRANSansWeb_Black.woff) format('woff'), url(https://oruji.github.io/static/font/ttf/IRANSansWeb_Black.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 700; src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Bold.eot); src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Bold.eot?#iefix) format('embedded-opentype'), url(https://oruji.github.io/static/font/woff2/IRANSansWeb_Bold.woff2) format('woff2'), url(https://oruji.github.io/static/font/woff/IRANSansWeb_Bold.woff) format('woff'), url(https://oruji.github.io/static/font/ttf/IRANSansWeb_Bold.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 500; src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Medium.eot); src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Medium.eot?#iefix) format('embedded-opentype'), url(https://oruji.github.io/static/font/woff2/IRANSansWeb_Medium.woff2) format('woff2'), url(https://oruji.github.io/static/font/woff/IRANSansWeb_Medium.woff) format('woff'), url(https://oruji.github.io/static/font/ttf/IRANSansWeb_Medium.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 300; src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Light.eot); src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_Light.eot?#iefix) format('embedded-opentype'), url(https://oruji.github.io/static/font/woff2/IRANSansWeb_Light.woff2) format('woff2'), url(https://oruji.github.io/static/font/woff/IRANSansWeb_Light.woff) format('woff'), url(https://oruji.github.io/static/font/ttf/IRANSansWeb_Light.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 200; src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_UltraLight.eot); src: url(https://oruji.github.io/static/font/eot/IRANSansWeb_UltraLight.eot?#iefix) format('embedded-opentype'), url(https://oruji.github.io/static/font/woff2/IRANSansWeb_UltraLight.woff2) format('woff2'), url(https://oruji.github.io/static/font/woff/IRANSansWeb_UltraLight.woff) format('woff'), url(https://oruji.github.io/static/font/ttf/IRANSansWeb_UltraLight.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 400; src: url(https://oruji.github.io/static/font/eot/IRANSansWeb.eot); src: url(https://oruji.github.io/static/font/eot/IRANSansWeb.eot?#iefix) format('embedded-opentype'), url(https://oruji.github.io/static/font/woff2/IRANSansWeb.woff2) format('woff2'), url(https://oruji.github.io/static/font/woff/IRANSansWeb.woff) format('woff'), url(https://oruji.github.io/static/font/ttf/IRANSansWeb.ttf) format('truetype') } .emph { color: #c7254e; background-color: #ffd7e3; border-radius: 4px; font-weight:bold;} .emphG { color: #2e9821; background-color: #e6f9d8; border-radius: 4px; font-weight: bold;} .search-form { text-align: center; padding-top:0; padding-bottom:10px; background-color: white; border-radius: 10px;} .search-input { width: 100%; padding: 10px 20px 10px 20px; margin-top: 0; margin-bottom: 5px; border-radius: 5px;} .search-btn { cursor: pointer; width: 100%; padding: 10px 20px 10px 20px; margin-top: 0; margin-bottom: 5px; border-radius: 5px; background-color: #366179; color: white;} a.alogo img { width: 120px;} img { max-width: 700px;} a.alogo h2 { font-size:0.87em;} .wide { margin-top: -12px; padding: 15px; float: right; margin-right: -15px;} .widetext { color: white; font-family: High Tower Text; font-weight: 600; font-size: 1.56em; margin-right: -10px; float: right; margin-top: -2px;} .widespan { display: block; font-size: 48%; font-weight: normal; margin-top: -11px; margin-right: 5px;} .logo { float: right; padding: 20px; width: 120px;} .fehrest { clear: both; margin-bottom: 20px; margin-top: 20px;} .plogo { overflow-x: initial;} .yaddasht { float: right; margin-left: 15px; width: 40px; height: 40px;} .imgCenter { display: block; margin: auto; border-radius: 2px;} .up { font-size: 0.83em; background-color: #f5f5f5; padding-right: 20px; padding-left: 20px; border-radius: 5px;} #navContent { display: none;} #uploadForm { float: left; color: grey;} @media only screen and (min-width:768px) { nav { width: 25%;} main { width: 75%;} .search-input { width: 400px;} .search-btn { width: 100px;} .search-form { padding-top: 30px; padding-bottom: 30px; background-color: #93abc3;}} @media only screen and (max-width:466px) { header { min-height: 114px }} .myClear { clear:both;} .mar0{margin:0} .mart-3{margin-top:-3px;} .mart10{margin-top:10px;} .marb10{margin-bottom:10px;} .padr20{padding-right:20px} .floatL{float:left} .floatR{float:right} .myPhone { float: left; direction: ltr; font-weight: bold; font-size: 0.87em; margin-left: 5px; font-style: italic; background: #e8eeff; color: black; border-radius: 5px; padding-right: 7px; height: 26px; padding-top: 1px;} .fontSize { display: inline; float: left; direction: ltr; font-weight:bold;} .increaseFont{ font-size: 1.06em; padding-right: 8px; padding-left: 8px; cursor:pointer;} .decreaseFont{ font-size: 0.81em; padding-right: 8px; padding-left: 8px; cursor:pointer;} .myHide { display:none;}</style>
</head>
<body>
<noscript>Your browser does not support JavaScript!</noscript>
<header class="gradient">
<a href="https://oruji.github.io/" title="oruji.github.io">
<img alt="oruji.github.io" src="https://oruji.github.io/static/img/wide.svg" class="wide">
<div class="widetext">oruji.github.io<span class="widespan">Persian Tutorials</span></div>        </a>
<ul class="social-icons"><li class="github"><a href="https://github.com/oruji" target="_blank" data-placement="bottom" title=" Github">Github</a></li><li class="twitter"><a href="https://twitter.com/oruji" target="_blank" data-placement="bottom" title=" Twitter">Twitter</a></li><li class="linkedin"><a href="https://www.linkedin.com/in/oruji/" target="_blank" data-placement="bottom" title=" Linkedin">Linkedin</a></li><li class="rss"><a href="https://oruji.github.io/feed.xml" target="_blank" data-placement="bottom" title="RSS Feed">rss</a></li></ul>
</header>
<main>
<div class="up">
ویرایش: <span dir=ltr>1396/11/13 19:19</span><div title="تغییر اندازه فونت" class="fontSize">
<span onclick="increaseFont()" class="increaseFont">A</span>
<span onclick="decreaseFont()" class="decreaseFont">A</span>
</div></div>
<div class="center"><h1>آموزش تولید محتوای غیر html ای در جنگو (Django)</h1><p>معمولا هنگامی که درباره ی deploy کردن وب سایت ها صحبت می شود، موضوع صحبت درباره ی تولید HTML می باشد. البته که موارد بسیار دیگری نیز وجود دارد؛ ما از وب برای توزیع داده در تمام قابل بندی ها استفاده می کنیم: RSS، PDF، عکس ها و غیره ....</p><p>تاکنون، تمرکز بر روی تولید HTML بوده است، ولی در <a title="آموزش محتوی غیر html در جنگو" class="content" href="https://oruji.github.io/django/non-html/">این آموزش</a> از کتاب، از این مسیر منحرف شده و به استفاده ی جنگو برای تولید انواع دیگر محتویات به غیر از HTML خواهیم پرداخت.</p><p>جنگو دارای ابزار داخلی مناسبی می باشد که می توان برای تولید برخی محتوای به غیر از HTML از آن استفاده کرد:</p><ul><li>   Feed های پیوند RSS/Atom</li><li>   Sitemap ها (یک قالب بندی XML توسعه داده شده توسط گوگل که به موتورهای جستجو راهنمایی هایی را می دهد)</li></ul><p>هر کدام از ابزار فوق در این فصل بررسی خواهند شد، ولی ابتدا قواعد اولیه را پوشش خواهیم داد.</p><h2>اصول اولیه: view ها و MIME-type ها</h2><p><a href="https://oruji.github.io/django/view/urlconf/" class="content" title="view urlconf">آموزش view  و urlconf جنگو</a> را بخاطر بیاورید که یک تابع view به سادگی یک تابپ پایتون می باشد که یک درخواست وب را دریافت کرده و یک پاسخ وب را بر می گرداند. این پاسخ می تواند محتویات HTML از صفحه ی وب یا یک تغییر مسیر، یا یک خطای 404، یا یک سند XML، یا حتی یک تصویر ... و یا هر چیز دیگری باشد.</p><p>به طور رسمی تر، یک تابع view جنگو باید</p><ul><li>قبول یک نمونه ی HttpRequest به صورت اولین آرگومان</li><li>برگرداندن یک نمونه ی HttpResponse</li></ul><p>نکته ی کلیدی جهت برگرداندن محتوای غیر HTML ای از یک view درون کلاس HttpResponse قرار دارد، به ویژه آرگومان mimetype. با قرار دادن mimetype ، می توان به مرورگر نشان داد که یک پاسخ از قالب بندی متفاوت را بر مر گردانیم.</p><p>برای مثال، اجازه دهید به view زیر که یک تصویر با قالب بندی PNG را بر می گرداند را بررسی کنیم، تنها فایل را از حافظه خوانده ایم:</p><code class="language-python">from django.http import HttpResponse

def my_image(request):
    image_data = open("/path/to/my/image.png", "rb").read()
    return HttpResponse(image_data, mimetype="image/png")</code><p>همین! در صورتی که شما مسیر تصویر را در فراخوانی <bdo class="leftInline">open()</bdo> با یک مسیر برای یک تصویر واقعی جا به جا کنید، می توانید از این view به سادگی برای نمایش یک تصویر استفاده کنید، و مرورگر به درستی آن را نمایش خواهد داد.</p><p>نکته ی مهم دیگر که باید در نظر داشت این است که، شیء های HttpResponse با API استاندارد پایتون یعنی "file like object" کار می کنند. این بدین معناست که می توان، از یک نمونه ی HttpResponse را در هر جای پایتون (یا یک کتابخانه ی third-party) که انتظار یک فایل را دارد استفاده کنید.</p><p>برای مثالی از نحوه ی کارکرد آن، اجازه دهید نگاهی به تولید CSV با جنگو بیاندازیم.</p><h3>تولید CSV</h3><p>CSV یک قالب بندی ساده می باشد که معمولا توسط نرم افزار spreadsheet استفاده می شود. اساسا یک سری از ردیف های جدول با هر سلول در ردیف جدا شده توسط یک علامت کاما می باشد (CVS مخفف comma‑seperated values می باشد). برای مثال، در زیر برخی داده های "unruly" مسافران هوایی در قالب بندی CSV می باشد.</p><code class="language-">Year,Unruly Airline Passengers
1995,146
1996,184
1997,235
1998,200
1999,226
2000,251
2001,299
2002,273
2003,281
2004,304
2005,203
2006,134
2007,147</code><ul><img src="https://oruji.github.io/static/img/note.svg" alt="جدول" class="yaddasht"><h4>نکته</h4><p>لیست قبلی حاوی اعداد واقعی می باشد! این لیست از مدیریت هواپیمایی فدرال آمریکا آمده است.</p></ul><p>هر چند CSV ساده به نظر می رسد، قالب بندی جزئیات آن دارای توافق جهانی نمی باشد. قسمت های مختلف نرم افزار CVS های مختلفی را تولید و استفاده می کند. خوشبختانه، پایتون دارای یک کتابخانه ی استاندار CSV با نام cvs می باشد.</p><p>به دلیل آنکه ماژول csv به صورت file-like objects کار می کند، استفاده از آن ساده تر از HttpResponse می باشد:</p><code class="language-python">import csv
from django.http import HttpResponse

# Number of unruly passengers each year 1995 - 2005. In a real application
# this would likely come from a database or some other back-end data store.
UNRULY_PASSENGERS = [146,184,235,200,226,251,299,273,281,304,203]

def unruly_passengers_csv(request):
    # Create the HttpResponse object with the appropriate CSV header.
    response = HttpResponse(mimetype='text/csv')
    response['Content-Disposition'] = 'attachment; filename=unruly.csv'

    # Create the CSV writer using the HttpResponse as the "file."
    writer = csv.writer(response)
    writer.writerow(['Year', 'Unruly Airline Passengers'])
    for (year, num) in zip(range(1995, 2006), UNRULY_PASSENGERS):
        writer.writerow([year, num])

    return response</code><p>کد فوق باید بسیار واضح باشد، ولی یک نکاتی ویژه برای ذکر کردن وجود دارد:</p><ul><li>Response به جای mimetype پیشفرض یعنی text/html با mimetype مورد نظر یعنی text/csv معین شده است.</li><li>  متغیر response یک Content-Disposition header اضافه دریافت می کند که حاوی نام فایل CSV می باشد. این header (بخش "attachment") مرورگر را برای یک جا جهت ذخیره کردن فایل به جای نمایش آن بر می انگیزد. نام این فایل دلخواه می باشد؛ آن را هر چه که می خواهید نام گذاری کنید. این توسط مرورگر در دیالوگ "Save As" استفاده خواهد شد.
  <p>جهت اختصاص دادن یک header در یک HttpResponse ، تنها کافیست به صورت یک دیکشنری و مجموعه ای از کلید و ارزش ها با آن رفتار کنید.</p></li><li>در دست ترجمه/تالیف ... به داخل API، CSV_generation ساده می باشد: تنها response را به صورت اولین آرگومان به csv.writer ارسال کنید.</li><li>برای هر ردیف در فایل CSV، فراخوانی writer.writerow مانند شیءی به صورت یک لیست یا تاپل آن را ارسال می کند.</li><li>  ماژول CSV برای گذاشتن کتیشن برای ما محتاط می باشد، بنابراین نگرانی ای درباره ی رد کردن رشته های با کتیشن یا کاما در آن ها نخواهید داشت. تنها اطلاعات را برای <bdo class="leftInline">writerow()</bdo> ارسال می کند.</li></ul><p>این الگوی کلی ای می باشد که شما در هر زمان که نیاز به برگرداندن محتوای غیر HTML ای دارید از آن استفاده خواهید کرد: ساختن یک شیء HttpResponse (با یک mimetype ویژه)، ارسال کردن آن به چیزی که انتظار یک فایل را دارد، و سپس برگرداند یک response.</p><p>اجازه دهید به نگاهی تعداد بیشتری از مثال بیاندازیم.</p><h3>ساختن PDF</h3><p><bdo class="leftInline">Portable Document Format (PDF)</bdo> یک قالب بندی توسعه یافته توسط Adobe می باشد که برای نمایش اسناد قابل چاپ استفاده می شود، قالب بندی pixel-perfect کامل، فونت های جاسازی شده، و گرافیک دو بعدی. می توان یک PDF را معادل دیجیتال یک سند چاپ شده دانست؛ در واقع، PDF ها اغلب در توزیع اسناد به قصد چاپ آن ها استفاده می شود.</p><p>می توان به سادگی PDF ها را با پایتون و جنگو، با تشکر از کتابخانه ی عالی منبع باز ReportLab تولید کرد (htt://www.reportlab.org/rl_toolkit.html). مزیت تولید فایل های PDF به طور پویا این است که، می توانید PDF های سفارشی را برای اهداف مختلف ایجاد کنید.</p><p>در دست ترجمه/تالیف ...</p><h4>نصب ReportLab</h4><p>قبل از تولید PDF نیاز می باشد ReportLab را نصب کنید که معمولا خیلی ساده می باشد: تنها کافیست کتابخانه ی آن را از http://www.reportlab.org/downloads.html دانلود و نصب کنید.</p><ul><img src="https://oruji.github.io/static/img/note.svg" alt="جدول" class="yaddasht"><h4>نکته</h4><p>در صورتیکه توزیع مدرن لینوک استفاده می کنید، ممکن است package management خود را قبل از نصب ReportLab بررسی کنید. اغلب repository های پکیج دارای ReportLab اضافه شده می باشند.</p><p>برای مثال، در صورتی که از ubuntu استفاده می کنید، به سادگی دستور apt-get install python-reportlab این کار را انجام خواهد داد.</p></ul><p>راهنمای کاربر (به طور طبیعی تنها به صورت یک فایل PDF در دسترس می باشد) در http://www.reportlab.org/rsrc/userguide.pdf دارای دستور العمل اضافه می باشد.</p><p>می توان نصب بودن ReportLab را با import کردن آن در interactive interpreter پایتون آزمایش کرد:</p><code class="language-python">&gt;&gt;&gt; import reportlab</code><p>در صورتیکه دستور فوق هیچ خطایی را ایجاد نکند، نصب درست انجام شده است.</p><h4>نوشتن view</h4><p>همانند CSV، تولید PDF ها به صورت پویا با جنگو ساده می باشد، چرا که API مخصوص ReportLab به صورت file‑like object عمل می کند.</p><p>در زیر مثال "Hello World" را مشاهده می کنید:</p><code class="language-python">from reportlab.pdfgen import canvas
from django.http import HttpResponse

def hello_pdf(request):
    # Create the HttpResponse object with the appropriate PDF headers.
    response = HttpResponse(mimetype='application/pdf')
    response['Content-Disposition'] = 'attachment; filename=hello.pdf'

    # Create the PDF object, using the response object as its "file."
    p = canvas.Canvas(response)

    # Draw things on the PDF. Here's where the PDF generation happens.
    # See the ReportLab documentation for the full list of functionality.
    p.drawString(100, 100, "Hello world.")

    # Close the PDF object cleanly, and we're done.
    p.showPage()
    p.save()
    return response</code><p>نکاتی در مورد کد فوق:</p><ul><li>  در کد فوق از mimetype مخصوص PDF یعنی application/pdf استفاده شده است. این حالت به مرورگرها می گوید که سند به جای یک فایل HTML، یک فایل PDF می باشد. در صورتی که این اطلاعات را جا بیاندازید، مرورگرها پاسخ را به صورت HTML تفسیر می کنند، نتیجه ی به هم ریخته و نا مفهومی در پنجره ی مرورگر ایجاد خواهد کرد.</li><li>  در دست ترجمه/تالیف ...: تنها کافیست response را به صورت آرگومان اول برای canvas.Canvas ارسال کنید. کلاس Canvas  انتظار یک file-like object را دارد، و شیء های HttpResponse نیز همینطور.</li><li>تمام متدهای در دست ترجمه/تالیف ...</li><li>در پایان، فراخوانی <bdo class="leftInline">showPage()</bdo> و <bdo class="leftInline">save()</bdo> در فایل PDF با اهمیت می باشد – در غیر این صورت در فایل PDF خراب خواهد شد.</li></ul><h4>PDF های پیچیده</h4><p>در صورتی که یک سند پیچیده ی PDF (یا هر قطعه داده ی بزرگ) را ایجاد می کنید، استفاده کردن از کتابخانه ی cStringIO به صورت یک محل نگهداری موقت برای فایل PDF خودتان را بررسی کنید. کتابخانه ی cStringIO یک رابط file-like object را تهیه می کند که برای حداکثر بهره وری در C نوشته شده است.</p><p>در زیر مثال "Hello World" قبلی با استفاده از cStringIO باز نویسی شده است:</p><code class="language-python">from cStringIO import StringIO
from reportlab.pdfgen import canvas
from django.http import HttpResponse

def hello_pdf(request):
    # Create the HttpResponse object with the appropriate PDF headers.
    response = HttpResponse(mimetype='application/pdf')
    response['Content-Disposition'] = 'attachment; filename=hello.pdf'

    temp = StringIO()

    # Create the PDF object, using the StringIO object as its "file."
    p = canvas.Canvas(temp)

    # Draw things on the PDF. Here's where the PDF generation happens.
    # See the ReportLab documentation for the full list of functionality.
    p.drawString(100, 100, "Hello world.")

    # Close the PDF object cleanly.
    p.showPage()
    p.save()

    # Get the value of the StringIO buffer and write it to the response.
    response.write(temp.getvalue())
    return response</code><h3>امکانات دیگر</h3><p>مجموعه ی کاملی از انواع دیگر محتویاتی که می توان در پایتون تولید کرد وجود دارد. در دست ترجمه/تالیف ...:</p><ul><li>  فایل های ZIP: کتابخانه ی استاندارد پایتون حاوی ماژول zipfile می باشد، که می تواند فایل های ZIP را هم بنویسد و هم بخواهند. می توان برای تولید بایگانی کردن تعدادی از فایل های مورد نیاز یا فشرده ساختن اسناد بزرگ از آن استفاده کرد. همچنین می توان فایل های TAR را با استفاده از ماژول tarfile در کتابخانه ی استاندارد پایتون تولید نمود.</li><li>تصاویر پویا: کتابخانه ی تصویر پایتون (PIL؛ <bdo class="leftInline">http://www.pythonware.com/products/pil/</bdo>)  یک جعبه ابزار خارق العاده برای تولید تصاویر (PNG، JPEG، GIF و مقدار بیشتری) می باشد. شما می توانید برای کاهش اندازه ی تصاویر به عکس های ریز به طور خودکار، تصاویر چندگانه ی مرکب در یک فریم و یا حتی برای انجام پردازش تصویر تحت وب از آن استفاده کنید.</li><li>طرح ها و نمودارها: تعدادی کتابخانه ی قدرتمند برای طرح ها و نمودارها در پایتون وجود دارد که می توان برای تولید نقشه های مورد نیاز، نمودارها، طرح ها و گرافیک ها از آن استفاده می کرد. مسلما نمی توان تمام آن ها را در اینجا لیست کرد، بنابراین تعداد از موارد برجسته در زیر نام برده شده اند:</li><li><ul><li><bdo class="leftInline">matplotlib (http://matplotlib.sourceforge.net/)</bdo> می تواند برای تولید نوعی از طرح های با کیفیت بالا که معمولا توسط MatLab یا Matematica تولید شده اند استفاده شود.</li><li><bdo class="leftInline">pygraphviz (http://networkx.lanl.gov/pygraphviz/)</bdo>، یک رابط برای لایه ی ابزار گرافیک <bdo class="leftInline">Graphviz (http://graphviz.org/)</bdo> می باشد، که می تواند برای تولید نمودارهای ساخت یافته از گرافیک ها و شبکه ها استفاده شود.</li></ul></li></ul><p>به طور کلی، هر کتابخانه ی پایتون قابل ایجاد درون یک فایل می تواند درون جنگو استفاده شود. امکانات عظیم می باشند.</p><p>اکنون که با قواعد اولیهه ی تولید محتوای غیر HTML ای، آشنا شدیم، اجازه دهید تصورمان را یک درجه افزایش دهیم. جنگو تعداد ابزار بسیار جذاب برای تولید انواع رایج محتوای غیر HTML ای ارائه می دهد.</p><h3>فریم ورک یا چارچوب Syndication Feed</h3><p>جنگو یک فریم ورک یا چارچوب سطح بالا syndication-feed-generating را ارائه می کند که ایجاد RSS و Atom را ساده می کند.</p><ul><img src="https://oruji.github.io/static/img/note.svg" alt="جدول" class="yaddasht"><h4>RSS چیست؟ Atom جیست؟</h4><p>RSS و Atom هر دو XML-based می باشند، که شما می توانید برای تهیه ی به روز رسانی به طور خودکار "feed" های محتویات سایت از آن استفاده کنید. برای اطلاعات بیشتر در مورد RSS می توانید به <bdo class="leftInline">http://www.whatsrss.com/</bdo> مراجعه کنید، و در <bdo class="leftInline">http://www.atomenabled.org/</bdo> نیر می توانید اطلاعاتی راجع به Atom بدست آوردید.</p></ul><p>برای ایجاد هر syndication feed، همه باید یک کلاس کوچک پایتون بنویسند. می توانید هر مقدار "feed" که می خواهید بسازید.</p><p>فریم ورک یا چارچوب سطح بالای feed-generating یک view می باشد که به طور قرارداد به /feeds/ وصل شده است. جنگو از باقی مانده ی URL (هر چیزی بعد از /feeds/) برای تعیین feed برای برگرداندن استفاده می کند.</p><p>برای ایجاد یک feed، شما یک Feed Class خواهید نوشت و در URLconf خود به آن اشاره می کنید.</p><h4>مقدار دهی اولیه</h4><p>برای فعال کردن syndication feed ها روی سایت جنگوی خود، URLconf زیر را اضافه کنید:</p><code class="language-python">(r'^feeds/(?P&lt;url&gt;.*)/$', 'django.contrib.syndication.views.feed',
    {'feed_dict': feeds}
),</code><p>این خط به جنگو می گوید؛ از فریم ورک RSS جهت کنترل تمام URL هایی که با "feeds/" شروع می شوند استفاده کند. (می توانید پیشوند "feeds/" را برای متناسب ساختن با نیازهای خودتان تغییر دهید.)</p><p>این خط URLconf دارای یک آرگومان اضافی می باشد: <bdo class="leftInline">{'feed_dict': feeds}</bdo>. از این آرگومان اضافه جهت ارسال feed هایی که باید تحت URL منتشر شده باشند استفاده کنید.</p><p>به طور خاص، feed_dict باید یک دیکشنری باشد که نام URL را به کلاس Feed مرتبط می کند. می توانید feed_dict را درون خود URLconf تعریف کنید. در زیر مثال کامل URLconf را ملاحظه می کنید:</p><code class="language-python">from django.conf.urls.defaults import *
from mysite.feeds import LatestEntries, LatestEntriesByCategory

feeds = {
    'latest': LatestEntries,
    'categories': LatestEntriesByCategory,
}

urlpatterns = patterns('',
    # ...
    (r'^feeds/(?P&lt;url&gt;.*)/$', 'django.contrib.syndication.views.feed',
        {'feed_dict': feeds}),
    # ...
)</code><p>مثال قبلی دو feed را در نظر گرفته است:</p><ul><li>feed اول که با LatestEntries نشان داده شده است و در <bdo class="leftInline">feeds/latest/</bdo> قرار خواهد گرفت.</li><li>دومین feed که با latestEntriesByCategory نمایش داده شده و در feeds/categories قرار خواهد گرفت.</li></ul><p>زمان راه اندازی، نیاز خواهید داشت خود کلاس های Feed را تعریف کنید.</p><p>یک کلاس Feed یک کلاس ساده ی پایتون می باشد که یک syndication feed را نشان می دهد. یک feed می تواند ساده باشد (مانند یک feed "سایت اخبار"، یا یک feed اولیه که آخرین ورودی های یک بلاگ را نمایش می دهد) یا بسیار پیچیده (مانند یک feed که تمام ورودی های بلاگ در یک طبقه بندی خاص جایی که طبقه بندی متغیر می باشد نمایش می دهد).</p><p>کلاس های Feed باید از کلاس django.contrib.syndication.feeds.Feed مشتق شوند. آن ها می توانند در هر جایی از درخت کد شما قرار بگیرند.</p><h4>یک Feed ساده</h4><p>مثال ساده ی زیر یک Feed از پنج ورودی آخر برای بلاگ داده شده را توضیح می دهد:</p><code class="language-python">from django.contrib.syndication.feeds import Feed
from mysite.blog.models import Entry

class LatestEntries(Feed):
    title = "My Blog"
    link = "/archive/"
    description = "The latest news about stuff."

    def items(self):
        return Entry.objects.order_by('-pub_date')[:5]</code><p>نکات قابل توجه در کد فوق از این قرار می باشند:</p><ul><li>کلاس فوق از کلاس django.contrib.syndication.feeds.Feed مشتق شده است.</li><li>title، link و description به ترتیب با المان های &lt;title&gt;، &lt;link&gt; و &lt;description&gt; برابر می باشند.</li><li><bdo class="leftInline">items()</bdo> یک متد می باشد که به سادگی یک لیست از شیء هایی که باید به صورت المان های &lt;item&gt; شامل شده در feed باشند بر می گرداند. اگر چه مثال فوق شیء های Entry را که از API پایگاه داده ی جنگو استفاده می کنند بر می گرداند، <bdo class="leftInline">item()</bdo> نباید نمونه های مدل را بر گرداند.</li></ul><p>تنها یک گام بیشتر وجود دارد. در یک RSS feed، هر &lt;item&gt; دارای یک &lt;title&gt;، &lt;link&gt; و &lt;description&gt; می باشد. نیاز است داده ای که قرار است برای درون آن المنت ها قرار گیرد، به فریم ورک گفته شود.</p><ul><li>برای تعیین محتویات &lt;title&gt; و &lt;description&gt;، template های جنگو را با نام های feeds/latest_title.html و feeds/latest_description.html ایجاد کنید، جایی که latest، slug تعیین شده در URLconf برای feed داده شده می باشد. توجه داشته باشید که پسوند .html الزامی می باشد.<p>سیستم RSS آن template را برای هر آیتم render می کند، ارسال آن دو متغیر template:</p></li><li>obj: شیء فعلی (هر کدام از شیء هایی که در <bdo class="leftInline">items()</bdo> بر گردانده شده است).</li><li>site: نمایش یک شیء django.models.core.sites.Site سایت فعلی. این برای <bdo class="leftInline">{{ site.domain }}</bdo> یا <bdo class="leftInline">{{ site.name }}</bdo> مفید می باشد.<p>در صورتیکه یک template برای title یا description ایجاد نکنید، فریم ورک به صورت پیشفرض از template، <bdo class="leftInline">{{ obj }}</bdo> استفاده می کند – این template نمایش رشته ی معمولی شیء می باشد. (برای شیء های مدل، این متد <bdo class="leftInline">__unicode__()</bdo> خواهد بود.)</p><p>همچنین می توان نام این دو template را از طریق تعیین title_template و description_template به صورت attribute های کلاس Feed تغییر داد.</p></li><li>برای تعیین محتویات &lt;link&gt;، دو option وجود دارد. برای هر آیتم در <bdo class="leftInline">items()</bdo>، جنگو ابتدا سعی می کند یک متد <bdo class="leftInline">get_absolute_url()</bdo> روی آن شیء اجرا کند. در صورتی که متد وجود نداشته باشد، سعی می کند یک متد <bdo class="leftInline">item_link()</bdo> در کلاس Feed فراخوانی کند، ارسال آن یک پارامتر تنها، item، که خود شیء می باشد.<p>هر دوی <bdo class="leftInline">get_absolute_url()</bdo> و <bdo class="leftInline">item_link()</bdo> باید URL ایتم را به صورت یک رشته ی معمولی پایتون بر گردانند.</p></li><li>برای مثال LatestEntries قبلی، می توانیم template های بسیار ساده ی feed را داشته باشیم. latest_title.html حاوی:<code class="language-python">{{ obj.title }}</code><p>و latest_description.html  حاوی:</p><code class="language-python">{{ obj.description }}</code><p>این اغلب بسیار ساده می باشد ...</p></li></ul><h4>یک Feed پیچیده تر</h4><p>فریم ورک همچنین feed های پیچیده تر را نیز از طریق پارامترها پشتیبانی می کند.</p><p>برای مثال، تصور کنید بلاگ شما یک RSS feed برای هر تگ مجزایی که شما برای طبقه بندی ورودی های خودتان استفاده کرده اید ارائه می کند. ساختن یک کلاس Feed جدا برای هر تگ احمقانه می باشد؛ نقض قانون <bdo class="leftInline">"Don't Repeat Yourself" (DRY)</bdo> می باشد.</p><p>در عوض، چارچوب syndication به شما اجازه می دهد feed های جنریکی ایجاد کنید که آیتم های متکی بر اطلاعات در آدرس feed ها را گردانند.</p><p>feed های تعیین تگ شما می تواند مانند زیر URL ها را استفاده کنند:</p><ul><li><bdo class="leftInline">http://example.com/feeds/tags/python/</bdo>: ورودی های فعلی علامت زده شده با "python" را بر می گرداند</li><li><bdo class="leftInline">http://example.com/feeds/tags/cats/</bdo>: ورودی های فعلی علامت زده شده با "cats" را بر می گرداند</li></ul><p>slug در اینجا "tags" می باشد. فریم ورک syndication، bit های URL اضافه ی بعد از slug را می بیند – 'python' و 'cats' – و به شما جهت گفتن معنی آن bit های URL و نحوه ی تاثیر آن ها در دست ترجمه/تالیف ...</p><p>یک مثال این موضوع را واضح تر می کند. در کد زیر feed های تگ تعیین را ملاحظه می کنید:</p><code class="language-python">from django.core.exceptions import ObjectDoesNotExist
from mysite.blog.models import Entry, Tag

class TagFeed(Feed):
    def get_object(self, bits):
        # In case of "/feeds/tags/cats/dogs/mice/", or other such
        # clutter, check that bits has only one member.
        if len(bits) != 1:
            raise ObjectDoesNotExist
        return Tag.objects.get(tag=bits[0])

    def title(self, obj):
        return "My Blog: Entries tagged with %s" % obj.tag

    def link(self, obj):
        return obj.get_absolute_url()

    def description(self, obj):
        return "Entries tagged with %s" % obj.tag

    def items(self, obj):
        entries = Entry.objects.filter(tags__id__exact=obj.id)
        return entries.order_by('-pub_date')[:30]</code><p>در کد فوق اصل اولیه ی الگوریتم فریم ورک RSS وجود دارد، به توجه به این کلاس و یک درخواست برای URL مورد نظر یعنی /feeds/tags/python/:</p><ol><li>فریم ورک آدرس /feeds/tags/python/ را دریافت می کند و ملاحظه می کند که یک تکه ی اضافی از URL بعد از slug وجود دارد. فریم ورک رشته ی باقی مانده را از توسط حرف <bdo class="leftInline">("/")</bdo> جدا کرده و متد کلاس Feed یعنی get_object را فراخوانی کرده و bit ها را به آن ارسال می کند.<p>در این مورد، bits مورد نظر ['python'] می باشد. برای یک درخواست به <bdo class="leftInline">/feeds/tags/python/django/</bdo>، bit ها ['python', 'django'] می باشند.</p></li><li><bdo class="leftInline">get_object()</bdo> مسئول بازیابی شیء Tag داده شده از bit های داده شده می باشد.<p>در این مورد، <bdo class="leftInline">get_object()</bdo> برای بازیابی Tag از API پایگاده داده ی جنگو استفاده می کند. توجه داشته باشید که <bdo class="leftInline">get_object()</bdo> در صورتیکه پارامتر های غیر معتبر داده شود، باید خطای django.core.exceptions.ObjectDoesNotExist ایجاد کند. هیچ try/except ای در اطراف فراخوانی Tag.DoesNotExist وجود ندارد، زیرا این کار ضروری نمی باشد. آن تابع زمان شکست Tag.DoesNotExist ایجاد می کند، و Tag.DoesNotexist از OjbectDoesNotexist مشتق شده است. بروز objectDoesNotexist در <bdo class="leftInline">get_object()</bdo>تولید یک خطای 404 برای آن درخواست را به جنگو می گوید.</p></li><li>برای تولید &lt;title&gt;، &lt;link&gt; و &lt;description&gt; مربوط به feed، جنگو متدهای <bdo class="leftInline">title()</bdo>، <bdo class="leftInline">link()</bdo> و <bdo class="leftInline">Description()</bdo> را مورد استفاده قرار می دهد. در مثال قبلی، آن ها attribute های ساده ی کلاس رشته بودند، ولی این مثال نشان می دهد که، آن ها می تواند هم رشته و هم متد باشند. برای هر title، link و description، جنگو الگوریتم زیر را دنبال می کند:<ol><li>1. سعی می کند یک متد را فراخوانی کند، ارسال آرگومان obj، جایی که obj شیءی می باشد که توسط <bdo class="leftInline">get_object()</bdo> بر گردانده شده است.</li><li>در صورت شکست، جنگو تلاش می کند یک متد با هیچ آرگومانی را فراخوانی کند.</li><li>در صورت شکست، جنگو attribute کلاس را استفاده می کند.</li></ol></li><li>در پایان، توجه داشته باشید که <bdo class="leftInline">items()</bdo> در این مثال همچنین آرگومان obj را نیز دریافت می کند. الگوریتم برای items همانند الگوریتم توضیح داده شده در گام قبلی می باشد – ابتدا، سعی می کند <bdo class="leftInline">items(obj)</bdo>، سپس <bdo class="leftInline">items()</bdo> و در پایان یک attribute کلاس items (که باید یک لیست باشد).</li></ol><p>مستندات کامل از تمام متدها و attribute ها از کلاس های Feed همواره از اسناد رسمی جنگو قابل دسترسی می باشد (http://docs.djangoproject.com/en/dev/ref/contrib/syndication)</p><h4>تعیین نوع Feed</h4><p>به طور پیشفرض، فریم ورک syndication، RSS 2.0 را تهیه می کند. برای تغییر آن، یک attribute، feed_type برای کلاس Feed خودتان اضافه کنید:</p><code class="language-python">from django.utils.feedgenerator import Atom1Feed

class MyFeed(Feed):
    feed_type = Atom1Feed</code><p>توجه داشته باشید که feed_type را برای یک شیء کلاس در نظر گرفته اید، نه یک نمونه، در حال حاضر انواع feed های در دسترس در جدول 1-11 نشان داده شده اند.</p><img src="https://oruji.github.io/static/img/table.svg" alt="جدول" class="yaddasht"><h4>جدول ۱-۱۳</h4><div class="myscroll"><table class="note"><tbody style="
    direction: ltr;
"><tr><th style="
    direction: rtl;
    min-width: 250px;
">کلاس Feed</th><th style="
    width: 170px;
    min-width: 170px;
">Format</th></tr><tr><td>Django.utils.feedgenerator.Rss201rev2Feed</td><td style="
    direction: ltr;
">RSS 2.01 (default)</td></tr><tr><td>Django.utils.feedgenerator.RssUserland091Feed</td><td style="
">RSS 0.91</td></tr><tr><td>Django.utils.feedgenerator.Atom1Feed</td><td>Atom 1.0</td></tr></tbody></table></div><h4>Enclosures</h4><p>برای تعیین enclosure ها (مانند منابع media مرتبط با یک آیتم feed مانند feed های MP3 podcast)، item_enclosure_url، item_enclosure_length و item_enclosure_mime_type را استفاده کنید، به عنوان مثال:</p><code class="language-python">from myproject.models import Song

class MyFeedWithEnclosures(Feed):
    title = "Example feed with enclosures"
    link = "/feeds/example-with-enclosures/"

    def items(self):
        return Song.objects.all()[:30]

    def item_enclosure_url(self, item):
        return item.song_url

    def item_enclosure_length(self, item):
        return item.song_length

    item_enclosure_mime_type = "audio/mpeg"</code><p>البته که شما یک شیء Song با فیلدهای song_url و song_length (مانند اندازه ی بایت ها) ساخته اید.</p><h4>Language</h4><p>Feed های ساخته شده توسط فریم ورک syndication به طور خودکار شامل تگ مناسب <bdo class="leftInline">&lt;language&gt; (RSS 2.0)</bdo> یا attribute، <bdo class="leftInline">xml:lang (Atom)</bdo> می باشند. این به طور مستقیم از تنظیم LANGUAGE_CODE آمده است.</p><h4>URLs</h4><p>لینک متد/attribute می تواند هم یک URL مستقل (مانند "/blog/") یا یک URL با آدرس کامل دامنه و پروتکل (مانند <bdo class="leftInline">"http://www.example.com/blog/"</bdo>) باشد. در صورتی که link دامنه را بر نگرداند، فریم ورک syndication دامنه ی سایت فعلی را به همراه تنظیم SITE_ID درج خواهد کرد. (برای اطلاعات بیشتر در مورد SITE_ID و چارچوب سایت ها به <a href="https://oruji.github.io/django/package/contrib/" class="content" title="پکیج django.contrib">پکیج django.contrib</a> مراجعه کنید.)</p><p>feed های Atom نیازمند یک <bdo class="leftInline">&lt;link rel="self"&gt;</bdo> می باشند که مکان فعلی feed را تعریف کند. فریم ورک syndication به طور خودکار این را قرار می دهد.</p><h4>انتشار feed های Atom و RSS پشت سر هم</h4><p>برخی از توسعه دهندگان تمایل دارند، فیلد های هر دو نسخه ی Atom و RSS در دسترس قرار دهند. انجام این کار با جنگو بسیار آسان می باشد: تنها کافیست یک کلاس فرزند از کلاس feed خود ایجاد کرده و feed_type را برای چیزی متفاوت قرار دهید. سپس URLconf خود را جهت اضافه کردن نسخه های اضافه به روز رسانی کنید. در زیر یک مثال کامل را ملاحظه می کنید:</p><code class="language-python">from django.contrib.syndication.feeds import Feed
from django.utils.feedgenerator import Atom1Feed
from mysite.blog.models import Entry

class RssLatestEntries(Feed):
    title = "My Blog"
    link = "/archive/"
    description = "The latest news about stuff."

    def items(self):
        return Entry.objects.order_by('-pub_date')[:5]

class AtomLatestEntries(RssLatestEntries):
    feed_type = Atom1Feed</code><p>و در زیر URL همراه:</p><code class="language-python">from django.conf.urls.defaults import *
from myproject.feeds import RssLatestEntries, AtomLatestEntries

feeds = {
    'rss': RssLatestEntries,
    'atom': AtomLatestEntries,
}

urlpatterns = patterns('',
    # ...
    (r'^feeds/(?P&lt;url&gt;.*)/$', 'django.contrib.syndication.views.feed',
        {'feed_dict': feeds}),
    # ...
)</code><h3>فریم ورک یا چارچوب نقشه ی سایت</h3><p>نقشه ی سایت یک فایل XML در وب سایت شما می باشد که به indexer های موتور جستجو نحوه ی تغییر مکرر و نحوه ی ارتباط برخی صفحات مهم با دیگر صفحات سایت شما را می گوید. این اطلاعات به موتورهای جستجوی فهرست سایت شما کمک می کند.</p><p>به عنوان مثال، در زیر یک تکه از نقشه ی سایت برای وب سایت جنگو وجود دارد (http://www.djangoproject.com/sitemap.xml):</p><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9"&gt;
  &lt;url&gt;
    &lt;loc&gt;http://www.djangoproject.com/documentation/&lt;/loc&gt;
    &lt;changefreq&gt;weekly&lt;/changefreq&gt;
    &lt;priority&gt;0.5&lt;/priority&gt;
  &lt;/url&gt;
  &lt;url&gt;
    &lt;loc&gt;http://www.djangoproject.com/documentation/0_90/&lt;/loc&gt;
    &lt;changefreq&gt;never&lt;/changefreq&gt;
    &lt;priority&gt;0.1&lt;/priority&gt;
  &lt;/url&gt;
  ...
&lt;/urlset&gt;</code><p>برای مشاهده ی نقشه ی سایت های بیشتر به http://www.sitemaps.org/ مراجعه کنید.</p><p>فریم ورک نقشه ی سایت جنگو، ساختن این فایل XML را با اجازه دادن به شما جهت بیان این اطلاعات در کد پایتون خودکار می کند. جهت ساختن یک نقشه ی سایت، تنها نیاز به نوشتن یک کلاس Sitemap و اشاره ی به آن درون URLconf می باشد.</p><h4>نصب</h4><p>جهت نصب برنامه ی نقشه ی سایت، مراحل زیر را دنبال کنید:</p><ol><li>'django.contrib.sitemaps' را به تنظیم INSTALLED_APPS اضافه کنید.</li><li>'django.template.loaders.app_directories.load_template_source'باید در تنظیم TEMPLATE_LOADERS وجود داشته باشد. این حالت به طور پیشفرض وجود دارد، بنابراین در صورتی که این تنظیم را تغییر داده اید، تنها کافیست آن را به حالت اول خود بر گردانید.</li><li>اطمینان حاصل کنید که سایت های چارچوب را نصب کرده اید (به <a href="https://oruji.github.io/django/package/contrib/" class="content" title="پکیج django.contrib">پکیج django.contrib</a> مراجعه کنید).</li></ol><ul><img src="https://oruji.github.io/static/img/note.svg" alt="جدول" class="yaddasht"><h4>نکته</h4><p>برنامه ی نقشه ی سایت در هر جدول دیتابیسی نصب نمی شود. تنها دلیلی که برای رفتن به داخل INSTALLED_APPS نیاز دارد این است که template loader مورد نظر یعنی load_template_source بتواند template های پیشفرض را پیدا کند.</p></ul><h4>مقدار دهی اولیه</h4><p>جهت فعال کردن تولید نقشه ی سایت در سایت جنگو، خط زیر را درون URLconf اضافه کنید:</p><code class="language-python">(r'^sitemap\.xml$', 'django.contrib.sitemaps.views.sitemap', {'sitemaps': sitemaps})</code><p>خط فوق برای ساختن یک نقشه ی سایت هنگامی که یک کلاینت به /sitemap.xml دسترسی پیدا می کند در نظر گرفته شده است. توجه داشته باشید که حرف نقطه در sitemap.xml با یک علامت ("\") میسر شده است، زیرا نقطه ها معنی خاصی در regular expression ها دارند.</p><p>نام فایل نقشه ی سایت اهمیتی ندارد، ولی مکان آن مهم می باشد. موتورهای جستجو تنها لینک ها را در نقشه ی سایت شما برای سطح URL فعلی و پایین فهرست می کنند. برای مثال، در صورتی که sitemap.xml در دایرکتوری ریشه ی شما می باشد، ممکن است به هر URL ای در سایت شما رجوع کند. در صورتی که نقشه ی سایت در /content/sitemap.xml باشد، ممکن است تنها به URL هایی که با /content/ شروع می شوند رجوع کند.</p><p>view نقشه ی سایت یک آرگومان اضافه ی الزامی دریافت می کند: {'sitemaps': sitemaps}. نقشه های سایت باید یک دیکشنری باشند که بخش کوتاه لیبلی (مانند blog یا news) را به کلاس Sitemap آن (مانند BlogSitemap یا NewsSitemap) مرتبط می سازد. همچنین ممکن است به یک instance از یک کلاس Sitemap (مانند <bdo class="leftInline">BlogSitemap(some_var)</bdo>) مرتبط سازد.</p><h4>کلاس های Sitemap</h4><p>یک کلاس Sitemap یک کلاس ساده ی پایتون می باشد که یک بخش از ورودی های نقشه ی سایت شما را نشان می دهد. برای مثال، یک کلاس Sitemap هنگامی که دیگری می تواند تمام رخدادها در در رخدادهای تقویم نشان دهد تمام ورودی های وبلاگ شما را نشان دهد.</p><p>در ساده ترین مورد، تمام این بخش ها با یکدیگر داخل یک sitemap.xml بدست می آیند، ولی استفاده از فریم ورک برای تولید یک فهرست نقشه ی سایت که به فایل های نقشه ی سایت منحصر به فرد نیز ممکن است، یکی برا هر بخش.</p><p>کلاس های Sitemap باید از کلاس django.contrib.sitemaps.Sitemap مشتق شوند. آن ها می توانند هر جایی در درخت کد پایتون شما قرار بگیرند.</p><p>برای مثال، فرض می کنیم شما دارای یک سیستم بلاگ می باشید، با یک مدل Entry، و می خواهید نقشه ی سایت تمام لینک ها به ورودی منحصر به فرد بلاگ را شامل شود. در زیر کلاس Sitemap مورد نظر وجود دارد:</p><code class="language-python">from django.contrib.sitemaps import Sitemap
from mysite.blog.models import Entry

class BlogSitemap(Sitemap):
    changefreq = "never"
    priority = 0.5

    def items(self):
        return Entry.objects.filter(is_draft=False)

    def lastmod(self, obj):
        return obj.pub_date</code><p>declare کردن نقشه ی سایت باید بسیار شبیه به یک Feed باشد. در دست ترجمه/تالیف ...</p><p>همانند کلاس های Feed، اعضای Sitemap می توانند متد یا attribute ها باشند. به بخش کمی قبل در این آموزش از کتاب، "یک مثال پیچیده" برای نحوه ی انجام این اعمال مراجعه کنید.</p><p>یک کلاس نقشه ی سایت می تواند متد/attribute های زیر را تعریف کند:</p><ul><li><bdo class="leftInline">items(required)</bdo>: لیستی از شیء ها تهیه می کند. فریم ورک نوع شیء هایی که هستند را زیر نظر ندارد؛ تمام موضوع این است که این شیء ها به متدهای <bdo class="leftInline">location()</bdo>، <bdo class="leftInline">lastmod()</bdo>، <bdo class="leftInline">changefreq()</bdo> و <bdo class="leftInline">priority()</bdo> ارسال شده باشند.</li><li>location(optional): URL مستقل برای شیء داده شده را می دهد. در اینجا، "URL مستقل" به معنی یک URL می باشد که شامل پروتکل یا دامنه نباشد. تعدادی مثال را در زیر مشاهده می کنید:<ul><li>خوب: '/foo/bar/'</li><li>بد: 'example.com/foo/bar/'</li><li>بد: 'http://example.com/foo/bar/'<p>در صورتیکه location تهیه نشده باشد، فریم ورک متد <bdo class="leftInline">get_absolute_url()</bdo> را در هر شیء به صورت برگشت داده شده توسط <bdo class="leftInline">items()</bdo> فراخوانی خواهد کرد.</p></li></ul></li><li><bdo class="leftInline">lastmod(optional)</bdo>: شیء های "آخرین اصلاح" زمان و تاریخ، به صورت یک شیء datetime پایتون.</li><li><bdo class="leftInline">changefreq(optional)</bdo>: هر چند وقت یک بار شیء را تغییر می دهد. مقادیر ممکن (به صورت داده شده توسط تعیین نقشه های سایت) به قرار زیر می باشند:<ul><li>'always'</li><li>'hourly'</li><li>'daily'</li><li>'weekly'</li><li>'monthly'</li><li>'yearly'</li><li>'never'</li></ul></li><li><bdo class="leftInline">priority(optional)</bdo>: یک پیشنهاد اولویت فهرست سازی بین 0.0 و 1.0. اولویت پیشفرض یک صفحه 0.5 می باشد؛ برای اطلاعات بیشتر درباره ی عمکرد اولویت به <bdo class="leftInline">http://sitemaps.org/</bdo> مراجعه کنید.</li></ul><h4>میانبرها</h4><p>فریم ورک نقشه ی سایت کلاس های مناسبی برای موارد مشترک تهیه کرده است. این کلاس ها در بخش های زیر توضیح داده شده اند.</p><h4>FlatPageSitemap</h4><p>کلاس django.contrib.sitemaps.FlatPageSitemap به تمام صفحات مسطح تعریف شده برای سایت فعلی نگاه می کند و یک ورودی در نقشه ی سایت ایجاد می کند. این ورودی ها تنها شامل attribute مورد نظر یعنی location می شوند – نه lastmod، changefreq یا priority.</p><p>برای اطلاعات بیشتر در مورد صفحات مسطخ به <a href="https://oruji.github.io/django/package/contrib/" class="content" title="پکیج django.contrib">پکیج django.contrib</a> مراجعه کنید.</p><h3>GenericSitemap</h3><p>کلاس GenericSitemap با هر view جنریکی کار می کند (به <a href="https://oruji.github.io/django/view/generic/" class="content" title="view generic">view های generic</a> مراجعه کنید) که شما آن ها را فرا گرفته اید.</p><p>برای استفاده از آن، یک نمونه بسازید، ارسال در info_dict یکسان که شما به view های جنریک ارسال می کنید. تنها نیازمندی این است که دیکشنری یک ورودی queryset داشته باشد. ممکن است همچنین یک ورودی date_field داشته باشد که یک فیلد تاریخ برای شیء های بازیابی شده از queryset را تعیین می کند. این برای attribute، lastmode در نقشه ی سایت تولید شده مورد استفاده قرار خواهد گرفت. شما ممکن است آرگومان های کیورد priority و changefreq را برای سازنده ی GenericSitemap جهت تعیین این attribute ها برای همه ی URL ها ارسال کنید.</p><p>در زیر مثالی از یک URLconf که از هر دوی FlatPageSitemap و GenericSiteMap (با شیء فرضی Entry از پیش) استفاده می کند وجود دارد:</p><code class="language-python">from django.conf.urls.defaults import *
from django.contrib.sitemaps import FlatPageSitemap, GenericSitemap
from mysite.blog.models import Entry

info_dict = {
    'queryset': Entry.objects.all(),
    'date_field': 'pub_date',
}

sitemaps = {
    'flatpages': FlatPageSitemap,
    'blog': GenericSitemap(info_dict, priority=0.6),
}

urlpatterns = patterns('',
    # some generic view using info_dict
    # ...

    # the sitemap
    (r'^sitemap\.xml$',
     'django.contrib.sitemaps.views.sitemap',
     {'sitemaps': sitemaps})
)</code><h4>ساخت فهرست نقشه ی سایت</h4><p>فریم ورک نقشه ی سایت همچنین دارای توانایی برای ساختن یک فهرست نقشه ی سایت می باشد که به فایل های منحصر به فرد نقشه ی سایت رجوع می کند، یکی برای هر بخش تعریف شده در دیکشنری sitemaps. تنها تفاوت ها در کاربرد هستند:</p><ul><li>شما از دو view در URLconf خود استفاده می کنید: django.contrib.views.index و django.conrib.sitemaps.views.sitemap.</li><li>django.contrib.sitemaps.views.sitemap باید یک آرگومان کیورد section دریافت کند.</li></ul><p>در زیر خطوط URLconf مربوط برای مثال قبلی وجود دارد:</p><code class="language-python">(r'^sitemap.xml$',
 'django.contrib.sitemaps.views.index',
 {'sitemaps': sitemaps}),

(r'^sitemap-(?P&lt;section&gt;. ).xml$',
 'django.contrib.sitemaps.views.sitemap',
 {'sitemaps': sitemaps})</code><p>کد فوق به طور اتوماتیک یک فایل sitemap.xml تولید می کند که به هر دوی sitemap-flatpages.cml و sitemap-blog.xml رجوع می کند. کلاس های Sitemap و دیکشنری sitemaps هیچگاه تغییر نمی کنند.</p><h4>پینگ کردن گوگل</h4><p>ممکن است بخواهید گوگل را هنگامی که نقشه ی سایت شما تغییر می کند پینگ کنید، تا به آن اجازه دهید دوباره فهرست گذاری سایت شما را بداند. چارچوب یک تابع تنها برای فقط برای این کار تهیه کرده است: <bdo class="leftInline">django.contrib.sitemaps.ping_google()</bdo>.</p><p><bdo class="leftInline">ping_google()</bdo> یک آرگومان اختیاری دریافت می کند، sitemap_url، که باید URL مستقل از نقشه ی سایت سایت شما باشد (مانند '/sitemap.xml'). در صورتی که آرگومان تهیه نشده باشد، <bdo class="leftInline">ping_google()</bdo> تلاش می کند نقشه ی سایت شما را توسط انجام یک جستجوی بر عکس در URLconf بسنجد.</p><p><bdo class="leftInline">ping_google()</bdo> در صورتی که نتواند URL نقشه ی سایت را تعیین کند، خطای django.contrib.sitemaps.SitemapNotFound را ایجاد خواهد کرد.</p><p>روش مفید برای فراخوانی ping_google به شکل یک متد <bdo class="leftInline">save()</bdo> مدل می باشد:</p><code class="language-python">from django.contrib.sitemaps import ping_google

class Entry(models.Model):
    # ...
    def save(self, *args, **kwargs):
        super(Entry, self).save(*args, **kwargs)
        try:
            ping_google()
        except Exception:
            # Bare 'except' because we could get a variety
            # of HTTP-related exceptions.
            pass</code><p>راهکار موثر تر، فراخوانی <bdo class="leftInline">ping_google()</bdo> از یک اسکریپت cron یا برخی وظایف برنامه ریزی شده ی دیگر می باشد. تابع یک HTTP request برای سرور های گوگل ایجاد می کند، بنابراین شما ممکن نیست بخواهید برای معرفی در هر بار فراخوانی <bdo class="leftInline">save()</bdo> بار اضافه ی شبکه را داشته باشید.</p><p>در پایان، در صورتی که 'django.contrib.sitemaps' درون تنظیم INSTALLED_APPS می باشد، manage.py شما شامل یک دستور جدید، ping_google خواهد بود. این برای دسترسی به پینگ کردن درون خط فرمان مفید می باشد. برای مثال:</p><code class="language-">python manage.py ping_google /sitemap.xml</code></div></main>
<nav class="gradient">
    <div class="titr-link">کتاب های آموزشی</div>
<a title="زبان جاوا" class="anav" href="https://oruji.github.io/java/">زبان جاوا</a><a title="زبان پایتون" class="anav" href="https://oruji.github.io/python/">زبان پایتون</a><a title="فریم ورک جنگو" class="anav" href="https://oruji.github.io/django/">فریمورک جنگو</a><a title="سیستم عامل لینوکس" class="anav" href="https://oruji.github.io/linux/">سیستم عامل لینوکس</a><a title="مطالب CSS" class="anav last-line" href="https://oruji.github.io/css/">مطالب CSS</a><div class="titr-link">کتاب آموزش جنگو</div>
<a href="https://oruji.github.io/django/introduction/" class="anav" title="مقدمه">مقدمه</a><a href="https://oruji.github.io/django/start/" class="anav" title="شروع کار">شروع کار</a><a href="https://oruji.github.io/django/view/urlconf/" class="anav" title="view ها و URLconf ها">view ها و URLconf ها</a><a href="https://oruji.github.io/django/template/" class="anav" title="Template ها">Template ها</a><a href="https://oruji.github.io/django/model/" class="anav" title="مدل ها">مدل ها</a><a href="https://oruji.github.io/django/admin-site/" class="anav" title="سایت مدیر">سایت مدیر</a><a href="https://oruji.github.io/django/form/" class="anav" title="فرم ها">فرم ها</a><a href="https://oruji.github.io/django/view/urlconf/advance/" class="anav" title="View ها و URLconf های پیشرفته">View ها و URLconf های پیشرفته</a><a href="https://oruji.github.io/django/template/advance/" class="anav" title="Template های پیشرفته">Template های پیشرفته</a><a href="https://oruji.github.io/django/model/advance/" class="anav" title="مدل های پیشرفته">مدل های پیشرفته</a><a href="https://oruji.github.io/django/view/generic/" class="anav" title="View های Generic">View های Generic</a><div  class="divnav" title="تولید محتوای غیر html ای">تولید محتوای غیر html ای</div><a href="https://oruji.github.io/django/session/" class="anav" title="Session ها، کاربران، و عضویت">Session ها، کاربران، و عضویت</a><a href="https://oruji.github.io/django/caching/" class="anav" title="مبحث Caching">مبحث Caching</a><a href="https://oruji.github.io/django/package/contrib/" class="anav" title="پکیج django.contrib">پکیج django.contrib</a><a href="https://oruji.github.io/django/middleware/" class="anav" title="مبحث Middleware">مبحث Middleware</a><a href="https://oruji.github.io/django/database/integrate/legacy/" class="anav" title="یکپارچه سازی برنامه ها و دیتابیس های Legacy">یکپارچه سازی برنامه ها و دیتابیس های Legacy</a><a href="https://oruji.github.io/django/internationalize/" class="anav" title="بین المللی سازی">بین المللی سازی</a><a href="https://oruji.github.io/django/security/" class="anav" title="امنیت">امنیت</a></nav>
<footer class="gradient">Copyright © 2020 - <a href="https://oruji.github.io/" title="آموزش آنلاین">oruji.github.io</a></footer></body>

</html>