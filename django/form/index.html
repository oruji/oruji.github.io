<!DOCTYPE html>
<html dir="rtl" lang="fa">



<head>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-43783552-5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-43783552-5');
</script>
<link rel="canonical" href="https://amoozesh.org/django/form/" />
<link rel="shortcut icon" href="https://amoozesh.org/static/img/favicon.ico" />
<title>فرم  در جنگو (Django) کتاب آموزش برخط فریم ورک چارچوب وب</title>
<meta name="description" content="کتاب اموزش برخط آنلاین چارچوب فریم ورک جنگو Django، فرم های HTML ستون فقرات تعامل وب سایت ها می باشند، در فرم های ساده می توان جعبه ی جستجوی گوگل را مثال زد" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="robots" content="index, follow" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="fontiran.com:license" content="ZM3QX" />
<meta name="msvalidate.01" content="338AFFB8975A4C65F4A4BC10CDAFF254" />
<meta property="og:title" content="فرم  در جنگو (Django) کتاب آموزش برخط فریم ورک چارچوب وب" />
<meta property="og:description" content="کتاب اموزش برخط آنلاین چارچوب فریم ورک جنگو Django، فرم های HTML ستون فقرات تعامل وب سایت ها می باشند، در فرم های ساده می توان جعبه ی جستجوی گوگل را مثال زد" />
<meta property="og:url" content="https://amoozesh.org/django/form/" />
<meta property="og:type" content="article" />
<script src="https://amoozesh.org/static/js/main.js"></script>
<style>
.token.bold,.token.important,.token.string{font-weight:700}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:20px;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#e7eeff}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.doctype,.token.prolog{color:#708090}.token.comment{color:#008a32}.token.punctuation{color:#999}.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.symbol{color:#000}.token.attr-name,.token.char,.token.inserted,.token.selector{color:#690}.token.builtin{color:#000}.token.string{color:#0f69ff}.language-css .token.string,.style .token.string,.token.entity,.token.url{color:#a67f59}.token.operator{color:#692d02}.token.atrule,.token.attr-value,.token.keyword{color:maroon;font-weight:700}.token.function{color:#000}.token.important,.token.regex{color:#e90}.token.variable{color:#b98118}.token.italic{font-style:italic}.token.entity{cursor:help}
</style>
<script src="https://amoozesh.org/static/js/prism.js"></script>


<style>
textarea, input, button, select { font-family: inherit; font-size: inherit;} p, li { text-align: justify;} main, nav { width: 100%;} .leftBlock, .leftInline, .logout, pre, canvas { direction: ltr;} .note td, pre { word-wrap: break-word;} body, main, div, footer, h1, h2, h3, h4, h5, h6, header, nav, input, button { -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0; padding: 0 } body { font-family: IRANSans; background-color: #fff; font-size: 1em; line-height: 35px;} nav { font-size: 0.83em; padding: 14px; float: right; margin-bottom: 2px;} header { color: #fff; margin: 2px; min-height: 86px; padding: 13px;} footer { font-size: 0.83em; text-align: center; padding: 30px; clear: both; color: #fff; margin: 2px;} pre { text-align: left; font-family: consolas, "Courier New", Courier, mono, serif; font-size: 0.86em; background-color: #e7eeff; padding: 8px 10px 8px 8px; color: #000; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; line-height: 20px; border-radius: 5px } code { direction: ltr; text-align: left; font-family: consolas, "Courier New", Courier, mono, serif; font-size: 0.92em; background-color: #e7eeff; padding: 10px !important; margin: 10px !important; color: #000; white-space: pre !important; white-space: -moz-pre-wrap !important; white-space: -pre-wrap !important; white-space: -o-pre-wrap !important; line-height: 20px; border-radius: 5px; display: block; overflow: auto; word-wrap: break-word;} .code { direction: ltr; text-align: left; font-family: consolas, "Courier New", Courier, mono, serif; font-size: 0.92em; background-color: #e7eeff; padding: 10px !important; margin: 10px !important; color: #000; white-space: pre !important; white-space: -moz-pre-wrap !important; white-space: -pre-wrap !important; white-space: -o-pre-wrap !important; line-height: 20px; border-radius: 5px; display: block; overflow: auto; word-wrap: break-word;} h1, h2, h3, h4, h5, h6 { font-weight: 500 !important } button { padding: 4px; border-radius: 5px;} .titr-link { text-align: center; font-weight: 700;} h1 { margin-bottom: 20px; margin-top: 20px; font-size: 1.5em;} h2 { font-size: 1.33em;} h3 { font-size: 1.17em;} h4 { font-size: 1.08em;} h5 { font-size: 1em;} textarea { height: 150px; font-size: inherit; line-height: 20px; width: 98%;} main { border-radius: 7px; background-color: #fff; padding-top: 15px; padding-bottom: 15px; padding-right: 20px; padding-left: 20px; min-height: 500px; box-shadow: 0 0 3px 1px #e0d9ff; float: right;} .logout { height: 40px; border-radius: 5px; color: #fff; margin: -5px 2px 2px; direction: ltr; padding-right: 10px; float: left;} .myClean { padding: 0; margin: 0;} .myscroll { display: block; overflow-x: auto } li { padding: 5px } .gradient { border-radius: 7px; background: linear-gradient(#001F38, #37627a); background: -moz-linear-gradient(#001F38, #37627a); background: -webkit-linear-gradient(#001F38, #37627a); background: -ms-linear-gradient(#001F38, #37627a); background: -o-linear-gradient(#001F38, #37627a) } .puzzle { white-space: nowrap;} a { color: #add8e6;} a.content { color: #4164ca;} .last-line, .titr-link { margin-bottom: 10px;} .titr-link { background-color: #e8eeff; border-radius: 5px;} .index, .index-style { border-radius: 4px; padding: 20px; display: block;} .index:hover { color: #add8e6; background-color: #366179;} .index-style { background-color: #e7eeff;} .index-style:hover { color: #add8e6; background-color: #366179;} .myTitle { margin-bottom: -10px } .anav, .anav:hover, .divnav { padding: 4px; display: block;} .divnav { color: #e7eeff; background-color: #366179; border-radius: 3px;} .anav { color: #add8e6;} .anav:hover { background-color: #3e6c8a; border-radius: 3px;} .myError { margin-bottom: 10px; margin-top: 5px; color: red;} .alogo { padding: 10.5px; float: right; color: #000; text-align: center; width: 150px;} .alogo:hover { padding: 10px; border-style: solid; border-radius: 10px; border-width: .5px;} .puzzle, ol, p, li { display: block; overflow-x: auto;} .leftBlock { text-align: left;} .radius5 { border-radius: 5px;} hr { margin-bottom: 15px; margin-top: 0;} .change-lang { margin-top: 5px; background-color: #e8eeff; color: #000; padding-right: 10px; padding-left: 10px; border-radius: 3px; line-height: 29px; text-align: center; height: 26px; display: block; padding-bottom: 5px;} .note { margin: 1em 0; width: 100%; overflow: hidden; background: #FFF; border-radius: 10px; border: 1px solid #167F92 } .note tr { border: 1px solid #D9E4E6 } .note tr:nth-child(odd) { background-color: #e0e0e0 } .note th { border: 1px solid #FFF; background-color: #167F92; color: #FFF } .note th:first-child { display: table-cell; text-align: center } .note th:nth-child(2) { display: table-cell } .note th:nth-child(2) span { display: block } .note th:nth-child(2):after { display: none } .note td { max-width: 7em; border: 1px solid #D9E4E6 } .note td:first-child { display: table-cell; text-align: center; border-right: 1px solid #D9E4E6 } .note td, .note th { display: table-cell; padding: 1em } a, ul.social-icons li a:hover { text-decoration: none } ul.social-icons { padding: 0; width: auto; overflow: initial; margin-top: 0; margin-bottom: 0; float: left;} ul.social-icons li { background-image: url(https://amoozesh.org/static/img/social-sprites.svg); background-repeat: no-repeat; background-color: #FFF; background-position: 0 100px; display: inline-block; margin: -1px 1px 5px 0; padding: 0; border-radius: 100%; overflow: visible; transition: all .3s ease; box-shadow: 0 2px 2px 0 rgba(0, 0, 0, .42); -moz-border-radius: 100%; -moz-transition: all .3s ease; -ms-transition: all .3s ease; -o-transition: all .3s ease; -webkit-border-radius: 100%; -webkit-transition: all .3s ease; border: 1.5px solid #12354d; margin-left: 3px; margin-right: 3px;} ul.social-icons li a { display: block; height: 28px; width: 28px; text-align: center } ul.social-icons li[class] a { text-indent: -9999px } ul.social-icons li a i[class^=icon-] { color: #444; font-style: 16px; position: relative; top: 3px } ul.social-icons li a:active { box-shadow: inset 0 0 10px rgba(0, 0, 0, .3), inset 0 0 10pxrgba(0, 0, 0, .3); -moz-box-shadow: inset 0 0 10px rgba(0, 0, 0, .3), inset 0 0 10pxrgba(0, 0, 0, .3); -webkit-box-shadow: inset 0 0 10px rgba(0, 0, 0, .3), inset 0 0 10pxrgba(0, 0, 0, .3) } ul.social-icons li a:active, ul.social-icons li:active { border-radius: 100%; -moz-border-radius: 100%; -webkit-border-radius: 100% } ul.social-icons li.facebook { background-position: 0 -001px } ul.social-icons li.facebook:hover { background-position: 0 -031px } ul.social-icons li.github { background-position: 0 -061px } ul.social-icons li.github:hover { background-position: 0 -091px } ul.social-icons li.rss { background-position: 0 -121px } ul.social-icons li.rss:hover { background-position: 0 -151px } ul.social-icons li.twitter { background-position: 0 -181px } ul.social-icons li.twitter:hover { background-position: 0 -211px } ul.social-icons li.googleplus { background-position: 0 -301px } ul.social-icons li.googleplus:hover { background-position: 0 -331px } ul.social-icons li.linkedin { background-position: 0 -241px } ul.social-icons li.linkedin:hover { background-position: 0 -271px } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 900; src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Black.eot); src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Black.eot?#iefix) format('embedded-opentype'), url(https://amoozesh.org/static/font/woff2/IRANSansWeb_Black.woff2) format('woff2'), url(https://amoozesh.org/static/font/woff/IRANSansWeb_Black.woff) format('woff'), url(https://amoozesh.org/static/font/ttf/IRANSansWeb_Black.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 700; src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Bold.eot); src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Bold.eot?#iefix) format('embedded-opentype'), url(https://amoozesh.org/static/font/woff2/IRANSansWeb_Bold.woff2) format('woff2'), url(https://amoozesh.org/static/font/woff/IRANSansWeb_Bold.woff) format('woff'), url(https://amoozesh.org/static/font/ttf/IRANSansWeb_Bold.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 500; src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Medium.eot); src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Medium.eot?#iefix) format('embedded-opentype'), url(https://amoozesh.org/static/font/woff2/IRANSansWeb_Medium.woff2) format('woff2'), url(https://amoozesh.org/static/font/woff/IRANSansWeb_Medium.woff) format('woff'), url(https://amoozesh.org/static/font/ttf/IRANSansWeb_Medium.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 300; src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Light.eot); src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_Light.eot?#iefix) format('embedded-opentype'), url(https://amoozesh.org/static/font/woff2/IRANSansWeb_Light.woff2) format('woff2'), url(https://amoozesh.org/static/font/woff/IRANSansWeb_Light.woff) format('woff'), url(https://amoozesh.org/static/font/ttf/IRANSansWeb_Light.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 200; src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_UltraLight.eot); src: url(https://amoozesh.org/static/font/eot/IRANSansWeb_UltraLight.eot?#iefix) format('embedded-opentype'), url(https://amoozesh.org/static/font/woff2/IRANSansWeb_UltraLight.woff2) format('woff2'), url(https://amoozesh.org/static/font/woff/IRANSansWeb_UltraLight.woff) format('woff'), url(https://amoozesh.org/static/font/ttf/IRANSansWeb_UltraLight.ttf) format('truetype') } @font-face { font-display: swap; font-family: IRANSans; font-style: normal; font-weight: 400; src: url(https://amoozesh.org/static/font/eot/IRANSansWeb.eot); src: url(https://amoozesh.org/static/font/eot/IRANSansWeb.eot?#iefix) format('embedded-opentype'), url(https://amoozesh.org/static/font/woff2/IRANSansWeb.woff2) format('woff2'), url(https://amoozesh.org/static/font/woff/IRANSansWeb.woff) format('woff'), url(https://amoozesh.org/static/font/ttf/IRANSansWeb.ttf) format('truetype') } .emph { color: #c7254e; background-color: #ffd7e3; border-radius: 4px; font-weight:bold;} .emphG { color: #2e9821; background-color: #e6f9d8; border-radius: 4px; font-weight: bold;} .search-form { text-align: center; padding-top:0; padding-bottom:10px; background-color: white; border-radius: 10px;} .search-input { width: 100%; padding: 10px 20px 10px 20px; margin-top: 0; margin-bottom: 5px; border-radius: 5px;} .search-btn { cursor: pointer; width: 100%; padding: 10px 20px 10px 20px; margin-top: 0; margin-bottom: 5px; border-radius: 5px; background-color: #366179; color: white;} a.alogo img { width: 120px;} img { max-width: 700px;} a.alogo h2 { font-size:0.87em;} .wide { margin-top: -12px; padding: 15px; float: right; margin-right: -15px;} .widetext { color: white; font-family: High Tower Text; font-weight: 600; font-size: 1.56em; margin-right: -10px; float: right; margin-top: -2px;} .widespan { display: block; font-size: 48%; font-weight: normal; margin-top: -11px; margin-right: 5px;} .logo { float: right; padding: 20px; width: 120px;} .fehrest { clear: both; margin-bottom: 20px; margin-top: 20px;} .plogo { overflow-x: initial;} .yaddasht { float: right; margin-left: 15px; width: 40px; height: 40px;} .imgCenter { display: block; margin: auto; border-radius: 2px;} .up { font-size: 0.83em; background-color: #f5f5f5; padding-right: 20px; padding-left: 20px; border-radius: 5px;} #navContent { display: none;} #uploadForm { float: left; color: grey;} @media only screen and (min-width:768px) { nav { width: 25%;} main { width: 75%;} .search-input { width: 400px;} .search-btn { width: 100px;} .search-form { padding-top: 30px; padding-bottom: 30px; background-color: #93abc3;}} @media only screen and (max-width:466px) { header { min-height: 114px }} .myClear { clear:both;} .mar0{margin:0} .mart-3{margin-top:-3px;} .mart10{margin-top:10px;} .marb10{margin-bottom:10px;} .padr20{padding-right:20px} .floatL{float:left} .floatR{float:right} .myPhone { float: left; direction: ltr; font-weight: bold; font-size: 0.87em; margin-left: 5px; font-style: italic; background: #e8eeff; color: black; border-radius: 5px; padding-right: 7px; height: 26px; padding-top: 1px;} .fontSize { display: inline; float: left; direction: ltr; font-weight:bold;} .increaseFont{ font-size: 1.06em; padding-right: 8px; padding-left: 8px; cursor:pointer;} .decreaseFont{ font-size: 0.81em; padding-right: 8px; padding-left: 8px; cursor:pointer;} .myHide { display:none;}
</style>
</head>
<!-- disable right click vv -->
<!-- <body oncontextmenu="return false;"> -->
<body>
<header class="gradient">
<a href="https://amoozesh.org/" title="amoozesh.org">
<img alt="amoozesh.org" src="https://amoozesh.org/static/img/wide.svg" class="wide">
<div class="widetext">amoozesh.org<span class="widespan">Persian Tutorials</span></div>        </a>
<ul class="social-icons"><li class="github"><a href="https://github.com/oruji" target="_blank" data-placement="bottom" title=" Github">Github</a></li><li class="twitter"><a href="https://twitter.com/oruji" target="_blank" data-placement="bottom" title=" Twitter">Twitter</a></li><li class="linkedin"><a href="https://www.linkedin.com/in/oruji/" target="_blank" data-placement="bottom" title=" Linkedin">Linkedin</a></li><li class="rss"><a href="https://amoozesh.org/feed.xml" target="_blank" data-placement="bottom" title="RSS Feed">rss</a></li></ul>
</header>
<main>
    
<div class="up">


ویرایش: <span dir=ltr>1398/2/28 15:23</span><div title="تغییر اندازه فونت" class="fontSize">
    <span onclick="increaseFont()" class="increaseFont">A</span>
    <span onclick="decreaseFont()" class="decreaseFont">A</span>
</div>
</div>

<div class="center">
<h1>آموزش فرم ها در جنگو (Django)</h1>
<p>فرم های HTML ستون فقرات تعامل وب سایت ها می باشند، برای فرم های ساده می توان جعبه ی جستجوی گوگل را مثال زد و برای فرم های پیچیده می توان رابط های ثبت نام برای سایت های بزرگ را مثال زد. در <a title="فرم ها در جنگو" class="content" href="https://amoozesh.org/django/form/">این آموزش</a> از کتاب به نحوه ی دسترسی به داده های فرم که توسط کاربر ارائه می شود، تایید کردن آن و انجام برخی کارها به روی آن ها خواهیم پرداخت. در طول فصل، HttpRequest و شیء های Form را توضیح خواهیم داد.</p>
<h2>دریافت داده از شیء Request</h2>
<p>شیء های HttpRequest در <a href="https://amoozesh.org/django/view/urlconf/" class="content" title="view urlconf">آموزش view  و urlconf جنگو</a> هنگامی که اولین توابع view را ایجاد کردیم معرفی شده است، ولی صحبت زیادی درباره ی آن ها در آن زمان صورت نگرفت. یادآوری می کنیم که هر تابع view یک شیء HttpRequest به عنوان اولین پارامتر دریافت می کند، همانطور که در تابع <bdo class="leftInline">hello()</bdo> مشاهده می کنید:</p>
<code class="language-python">from django.http import HttpResponse

def hello(request):
    return HttpResponse("Hello world")</code><p>شیء های HttpRequest مانند متغیر request فوق، دارای attribute های و متدهای جالبی می باشند که می بایست با آن ها آشنا شوید. می توان از این attribute ها برای به دست آوردن اطلاعات درباره ی درخواست فعلی استفاده کرد (مانند مرورگری که در حال بارگذاری صفحه ی فعلی می باشد)، در زمانی که تابع view اجرا شده است.</p>
<h4>اطلاعات درباره ی آدرس</h4>
<p>شیء های HttpRequest حاوی چندین بخش از اطلاعات درباره ی آدرس فعلی درخواست شده می باشد:</p>
<img src="https://amoozesh.org/static/img/table.svg" alt="جدول" class="yaddasht"><h4>جدول ۱-۷</h4>
<div class="myscroll"><table class="note"><tbody>
<tr>
<th style="
    min-width: 186px;
    width: 190px;
">متد/Attribute</th>
<th style="
    min-width: 190px;
">توضیح</th>
<th style="
    min-width: 175px;
">مثال</th>
</tr>
<tr>
<td>request.path</td>
<td>مسیر کامل، بدون شامل بودن دامین ولی با علامت (/) پیشین</td>
<td>"/hello/"</td>
</tr>
<tr>
<td><bdo class="leftInline">Request.get_host()</bdo></td>
<td>میزبان (مانند دامین در گفتگوی رایج)</td>
<td>
<bdo class="leftInline">"127.0.0.1:8000"</bdo> یا "www.example.com"</td>
</tr>
<tr>
<td><bdo class="leftInline">Request.get_full_path()</bdo></td>
<td>مسیر به همراه query string (اگر در دسترس باشد)</td>
<td><bdo class="leftInline">"/hello/?print=true"</bdo></td>
</tr>
<tr>
<td><bdo class="leftInline">Request.is_secure()</bdo></td>
<td>در صورتیکه درخواست از طریق HTTPS ساخته شده باشد True و در غیر اینصورت False بر می گرداند.</td>
<td>True یا False</td>
</tr>
</tbody></table></div>
<p>همواره از attribute ها/متدها به جای کد مستقیم آدرس درون view ها استفاده کنید. حرکت مذکور انعطاف پذیری کد را جهت استفاده در مکان های دیگر بیشتر می کند. یک مثال ساده:</p>
<code class="language-python"># BAD!
def current_url_view_bad(request):
    return HttpResponse("Welcome to the page at /current/")

# GOOD
def current_url_view_good(request):
    return HttpResponse("Welcome to the page at %s" % request.path)</code><h4>اطلاعات دیگر درباره ی Request</h4>
<p>request.META یک دیکشنری پایتون است که تمام HTTP header های درخواست داده شده را شامل شده است – مانند آدرس IP و همچنین نام و نسخه ی مرورگر کاربر. توجه داشته باشید که لیست header های در دسترس به آن header هایی بستگی دارد که کاربر فرستاده و وب سرور قرار داده است. برخی از کلید های در دسترس رایج در این دیکشنری:</p>
<ul>
<li>HTTP_REFERER - اشاره کردن به آدرس، در صورت وجود.</li>
<li>HTTP_USER_AGENT – رشته ی مرورگر کاربر، در صورت وجود. که چیزی شبیه به این می باشد:<br><bdo class="leftInline">"Mozilla/5.0 (X11; U; Linux i686; fr-FR; rv:1.8.1.17) Gecko/20080829 Firefox/2.0.0.17".</bdo>
</li>
<li>REMOTE_ADDR – آدرس IP کلاینت مانند "<bdo class="leftInline">12.345.67.89</bdo>". (در صورتیکه درخواست از میان پروکسی ارسال شده باشد، ممکن است با یک جدا کننده ی کاما نشان داده شود مانند "<bdo class="leftInline">12.345.67.89,23.456.78.90</bdo>")</li>
</ul>
<p>توجه داشته باشید، چراکه request.META یک دیکشنری پایتون می باشد، در صورتیکه بخواهید به کلیدی که وجود ندارد دسترسی پیدا کنیدخطای KeyError رخ خواهد داد. (زیرا HTTP header داده ی خارجی می باشد – که توسط مرورگر کاربر شما تایید شده است – نباید به آن ها اعتماد شود، و باید همواره برنامه ی خود را طوری طراحی کنید که در صورت خالی بودن یک header خاص یا عدم وجود به شکل درستی آن را رد کند.) می بایست از یک عبارت try/except یا متد <bdo class="leftInline">get()</bdo> برای مواردی که یک کلید تعریف نشده است استفاده کرد:</p>
<code class="language-python"># BAD!
def ua_display_bad(request):
    ua = request.META['HTTP_USER_AGENT']  # Might raise KeyError!
    return HttpResponse("Your browser is %s" % ua)

# GOOD (VERSION 1)
def ua_display_good1(request):
    try:
        ua = request.META['HTTP_USER_AGENT']
    except KeyError:
        ua = 'unknown'
    return HttpResponse("Your browser is %s" % ua)

# GOOD (VERSION 2)
def ua_display_good2(request):
    ua = request.META.get('HTTP_USER_AGENT', 'unknown')
    return HttpResponse("Your browser is %s" % ua)</code><p>شما را تشویق می کنیم تا یک view کوچک بنویسید که تمام داده های request.META را نمایش دهد بنابراین می توانید با دلیل وجود آن ها را آشنا شوید:</p>
<code class="language-python">def display_meta(request):
    values = request.META.items()
    values.sort()
    html = []
    for k, v in values:
        html.append('&lt;tr&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;/tr&gt;' % (k, v))
    return HttpResponse('&lt;table&gt;%s&lt;/table&gt;' % '\n'.join(html))</code><p>همچنین می توان view فوق را با استفاده از سیستم template جنگو به جای نوشتن کد مستقیم HTML تبدیل کنید. همچنین سعی کنید request.path و دیگر متدهای HttpRequest را از فصل قبل اضافه کنید.</p>
<h4>اطلاعات درباره ی داده ی تایید (submit) شده</h4>
<p>خارج از ابر داده های پایه درباره ی درخواست، شیء های HttpRequest دارای دو attribute هستند که حاوی اطلاعات تایید شده توسط کاربر می باشند: request.GET و request.POST. هر دوی این ها شیء های دیکشنری مانند می باشند که از طریق آن ها می توان به داده های نوع GET و POST دسترسی پیدا کرد.</p>
<ul>
<img src="https://amoozesh.org/static/img/note.svg" alt="جدول" class="yaddasht"><h4>شیء های دیکشنری مانند</h4>
<p>هنگامی که گفته می شود request.GET و request.POST شیء های دیکشنری مانند می باشند، منظور این است که آن ها مانند دیکشنری های استاندارد پایتون رفتار می کنند ولی از نظر فنی دیکشنری پایتون نمی باشند. به عنوان مثال، request.GET و request.POST دارای متدهای <bdo class="leftInline">get()</bdo>، <bdo class="leftInline">keys()</bdo> و <bdo class="leftInline">value()</bdo> هستند، می توان درون کلیدها با for key in request.GET به جستجو پرداخت.</p>
<p>بنابراین چرا با یکدیگر فرق می کنند؟ زیرا هر دوی request.GET و request.POST دارای متدهای اضافی ای می باشند که دیکشنری های معمولی فاقد آن متدها می باشند. </p>
<p>شما ممکن است با اصطلاح شبیه به اصطلاح قبلی یعنی شیء های فایل مانند مواجه شده باشید – شیء های پایتون دارای تعدادی متد اولیه می باشند، مانند <bdo class="leftInline">read()</bdo> که اجازه می دهد به صورت جانشین برای شیء های واقعی فایل ایفای نقش کنند.</p>
</ul>
<p>داده ی POST عموما تایید شده از <bdo class="leftInline">&lt;form&gt; HTML</bdo> می باشد، در حالی که داده ی GET می تواند از یک &lt;form&gt; یا query string در آدرس صفحه آمده باشد.</p>
<h3>یک مثال ساده ی کنترل فرم</h3>
<p>مثال books کتاب را با کتاب ها، نویسندگان و ناشران دنبال می کنیم، اجازه دهید یک view ساده را که به کاربران اجازه ی جستجو کتاب ها را بر اساس عنوان می دهد، بسازیم.</p>
<p>معمولا، دو بخش برای توسعه ی یک فرم وجود دارد: رابط کاربر HTML و کد view که در بطن کار قرار دارد و داده ی تایید شده توسط کاربر را پردازش می کند. بخش اول ساده می باشد؛ اجازه دهید یک view را که فرم جستجو را نمایش می دهد راه اندازی کنیم:</p>
<code class="language-python">from django.shortcuts import render_to_response

def search_form(request):
    return render_to_response('search_form.html')</code><p>همانطور که در <a href="https://amoozesh.org/django/view/urlconf/" class="content" title="view urlconf">آموزش view  و urlconf جنگو</a> یاد گرفتیم، view فوق را می تواند هر جایی در مسیر پایتون قرار دهیم. در اینجا آن را درون books/views.py قرار می دهیم.</p>
<p>template همراه، search_form.html چیزی شبیه به کد زیر خواهد بود:</p>
<code class="language-django">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Search&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form action="/search/" method="get"&gt;
        &lt;input type="text" name="q"&gt;
        &lt;input type="submit" value="Search"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><p>URLpattern در urls.py نیز می تواند چیزی شبیه به کد زیر باشد:</p>
<code class="language-python">from mysite.books import views

urlpatterns = patterns('',
    # ...
    (r'^search-form/$', views.search_form),
    # ...
)</code><p>(توجه داشته باشید که ماژول views به جای آنکه به این شکل from mysite.views imort search_form به درون برنامه import شود، به طور مستقیم import شده است، زیرا این روش کوتاه تر می باشد، این روش import در <a href="https://amoozesh.org/django/view/urlconf/advance/" class="content" title="view urlconf پیشترفته">آموزش view و urlconf پیشرفته</a> با جزئیات بیشتری بحث خواهد شد.)</p>
<p>حالا، در صورتیکه دستور runserver را اجرا کنید و آدرس <bdo class="leftInline">http://127.0.0.1:8000/search‑form/</bdo> درون مرورگر ملاحظه کنید، رابط جستجو را ملاحظه خواهید کرد که به اندازه ی کافی ساده می باشد.</p>
<p>سعی کنید که فرم را تایید کنید، که در اینصورت خطای 404 جنگو را مشاهده خواهید کرد. فرم به آدرس /search/ اشاره می کند، که هنوز اجرا نشده است. اجازه دهید این مشکل را با view دوم حل کنیم:</p>
<code class="language-python"># urls.py

urlpatterns = patterns('',
    # ...
    (r'^search-form/$', views.search_form),
    (r'^search/$', views.search),
    # ...
)

# views.py

def search(request):
    if 'q' in request.GET:
        message = 'You searched for: %r' % request.GET['q']
    else:
        message = 'You submitted an empty form.'
    return HttpResponse(message)</code><p>در حال حاضر، کد فوق تنها یک صفحه ی جستجو را نمایش می دهد، ولی می توان مطمئن شد که داده برای جنگو ارسال شده است، و می توان نحوه ی جریان جستجو را در سیستم متوجه شد. به طور خلاصه:</p>
<ol>
<li>&lt;form&gt; یک متغیر q تعریف می کند. هنگامی که فرم تایید می شود، ارزش q از طریق <bdo class="leftInline">GET (method="get")</bdo> به آدرس /search/ فرستاده می شود.</li>
<li>view جنگو که آدرس <bdo class="leftInline">/search/ (search())</bdo> را کنترل می کند به ارزش q در request.GET دسترسی دارد.</li>
</ol>
<p>نکته مهم برای اشاره در اینجا این است که، به طور صریح بررسی شده است که 'q'درون request.GET وجود دارد یا خیر. همانطور که در بخش گذشته به request.META اشاره شد، شما نباید به هرچیزی که توسط کاربر فرستاده می شود اعتماد کنید و یا حتی فرض کنید که در وهله ی اول چیزی ارسال نمی شود. در صورتیکه این بررسی صورت نگیرد، هر ارسالی از فرم خالی باعث بروز خطای KeyError خواهد شد:</p>
<code class="language-python"># BAD!
def bad_search(request):
    # The following line will raise KeyError if 'q' hasn't
    # been submitted!
    message = 'You searched for: %r' % request.GET['q']
    return HttpResponse(message)</code><ul>
<img src="https://amoozesh.org/static/img/note.svg" alt="جدول" class="yaddasht"><h4>پارامترهای query string</h4>
<p>داده ی GET در query string ارسال می شود (مانند <bdo class="leftInline">/search/?q=django</bdo>)، می توان برای دسترسی به متغیرهای query string از request.GET استفاده کرد. در <a href="https://amoozesh.org/django/view/urlconf/" class="content" title="view urlconf">آموزش view  و urlconf جنگو</a> در بخش معرفی سیستم URLconf جنگو، آدرس های زیبای جنگو با آدرس های قدیمی PHP/Java مانند <bdo class="leftInline">/time/plus?hours=3</bdo> مقایسه شد و همچنین گفته شد که در <a href="https://amoozesh.org/django/form/" class="content" title="آموزش فرم جنگو">فرم</a> نحوه ی دسترسی به به این آدرس های قدیمی نشان داده خواهد شد. حالا نحوه ی دسترسی به پارامترهای query string در view (مانند hours=3 در مثال فوق) را می دانید – با استفاده از request.GET.</p>
</ul>
<p>داده ی پست نیر مانند داده ی GET عمل می کند – تنها از request.POST به جای request.GET استفاده می کند. تفاوت بین GET و POST در چیست؟ از روش GET هنگامی که تنها یک درخواست برای بدست آوردن داده می باشد استفاده می شود. از داده ی پست هر زمان که ارسال درخواست دارای برخی تاثیرات زیان بار باشد استفاده می شود – تغییر دادن داده، اراسل یک پست الکترونیک، و یا چیز دیگر که ورای نمایش ساده ی داده باشد. در مثال جستجوی ما، از روش GET استفاده شده است که زیرا هیچ داده ای قرار نیست درون سرور تغییر کند. (در صورتیکه می خواهید اطلاعات بیشتری در رابطه با روش های GET و POST به دست آورید می توانید به این آدرس مراجعه کنید: <a title="use of HTTP GET and POST" class="content" href="http://www.w3.org/2001/tag/doc/whenToUseGet.html">use of HTTP GET and POST</a>).</p>
<p>اکنون که از روش GET استفاده شده است، اجازه دهید درون پایگاه داده به جستجوی کتاب مورد نظر بگردیم:</p>
<code class="language-python">from django.http import HttpResponse
from django.shortcuts import render_to_response
from mysite.books.models import Book

def search(request):
    if 'q' in request.GET and request.GET['q']:
        q = request.GET['q']
        books = Book.objects.filter(title__icontains=q)
        return render_to_response('search_results.html',
            {'books': books, 'query': q})
    else:
        return HttpResponse('Please submit a search term.')</code><p>نکاتی که در کد فوق وجود دارد:</p>
<ul>
<li>گذشته از بررسی اینکه 'q' درون request.GET وجود دارد یا خیر، همچنین در کد فوق قبل از اینکه مقادی به پایگاه داده ارسال شود اطمینان حاصل شده است که <bdo class="leftInline">request.GET['q']</bdo> مقدار خالی نداشته باشد.</li>
<li>درون کد فوق از Book.objects.filter(title__icontains=q) جهت پرسیدن اینکه آیا عنوانی شامل 'q' درون جدول کتاب ها وجود دارد یا خیر استفاده شده است. icontains یک نوع جستجو (که در <a href="https://amoozesh.org/django/model/" class="content" title="مدل">آموزش مدل جنگو</a> توضیح داده شده است) می باشد، عبارت می تواند تقریبا به این حالت ترجمه شود که "کتاب هایی که حاوی q بدون حساسیت به حروف بزرگ و کوچک می باشند را جستجو کن".<p>این یک روش بسیار ساده برای جستجوی کتاب می باشد. البته پیشنهاد نمی شود که از icontains در پایگاه داده های بزرگ محصولات استفاده شود زیرا در این حالت می تواند بسیار کند عمل کند.</p>
</li>
<li>books (یک لیست از شیء های کتاب) به template ارسال شده است. کد template برای search_results.html ممکن است شامل چیزی شبیه به این باشد:<code class="language-django">&lt;p&gt;You searched for: &lt;strong&gt;{{ query }}&lt;/strong&gt;&lt;/p&gt;

{% if books %}
    &lt;p&gt;Found {{ books|length }} book{{ books|pluralize }}.&lt;/p&gt;
    &lt;ul&gt;
        {% for book in books %}
        &lt;li&gt;{{ book.title }}&lt;/li&gt;
        {% endfor %}
    &lt;/ul&gt;
{% else %}
    &lt;p&gt;No books matched your search criteria.&lt;/p&gt;
{% endif %}</code><p>به کاربرد فیلتر template فوق یعنی pluralize توجه کنید، در صورتیکه مقدار لیست books بیشتر از یکی باشد حرف "s" را بر می گرداند.</p>
</li>
</ul>
<h3>اصلاح نمودن مثال ساده ی کنترل فرم</h3>
<p>همانند فصل گذشته، یک فرم ساده از موضوع مورد بحث را نشان دادیم، حالا به برخی از مشکلات اشاره کرده و نحوه ی اصلاح آن را نشان خواهیم داد.</p>
<p>ابتدا، کنترل کردن یک ورودی خالی توسط تابع <bdo class="leftInline">search()</bdo> بسیار ضعیف می باشد – تنها نمایش داده یک پیام "Please submit a search term."، نیازمند این است که کاربر دکمه ی برگشت مرورگر را برای بازگشت به صفحه فشار دهد. این یک حالت نامطلوب و غیر حرفه ای می باشد، و در صورتیکه همیشه به این شکل کار می کنید، شما از امتیازات ویژه ی جنگو خود را محروم خواهید کرد.</p>
<p>اینکه در هنگام بروز خطا فرم نیز دوباره نمایش داده شود خیلی روش بهتری می باشد، به طوری که خطا در همان صفحه و در بالای فرم نمایش داده شود و کاربر بتواند به سرعت دوباره فرم را پر کرده و ارسال کند، چیزی مانند کد زیر:</p>
<code class="language-python">from django.http import HttpResponse
from django.shortcuts import render_to_response
from mysite.books.models import Book

def search_form(request):
    return render_to_response('search_form.html')

def search(request):
    if 'q' in request.GET and request.GET['q']:
        q = request.GET['q']
        books = Book.objects.filter(title__icontains=q)
        return render_to_response('search_results.html',
            {'books': books, 'query': q})
    else:
        return render_to_response('search_form.html', {'error': True})</code><p>(توجه داشته باشید که تابع <bdo class="leftInline">search_form()</bdo> در کد فوق ایجاد شده است، بنابراین شما می توانید هر دوی view را در یک مکان مشاهده کنید.)</p>
<p>در مثال فوق تابع <bdo class="leftInline">search()</bdo> در صورتیکه فرم ارسالی خالی باشد، برای ارائه ی دوباره ی template مورد نظر یعنی search_form.html اصلاح شده است. و بدلیل نمایش یک پیام خطا در آن template، یک متغیر template ارسال شده است. حالا می توان search_form.html را جهت بررسی متغیر error بدین شکل ویرایش کرد:</p>
<code class="language-django">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Search&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    {% if error %}
        &lt;p style="color: red;"&gt;Please submit a search term.&lt;/p&gt;
    {% endif %}
    &lt;form action="/search/" method="get"&gt;
        &lt;input type="text" name="q"&gt;
        &lt;input type="submit" value="Search"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><p>می توان همچنان از این template برای view اصلی یعنی <bdo class="leftInline">search_form()</bdo> استفاده کرد، زیرا <bdo class="leftInline">search_form()</bdo> هیچ متغیر error ای به template ارسال نمی کند – بنابراین پیام خطا در این مورد نشان داده نخواهد شد.</p>
<p>با تغییر فوق در اینجا، برنامه ی فعلی بهتر شده است، ولی این سوال پیش می آید: آیا وجود تابع <bdo class="leftInline">search_form()</bdo> واقعا ضروری است؟ یک درخواست به آدرس /search/ (بدون هیچ پارامتری از نوع GET) یک فرم خالی را نمایش خواهد داد (ولی با یک خطا). می توان تابع <bdo class="leftInline">search_form()</bdo> را به همراه URLpattern های همراه آن، تا زمانیکه کسی با هیچ پارامتر GET ای از /search/ بازدید می کند حذف نمود:</p>
<code class="language-python">def search(request):
    error = False
    if 'q' in request.GET:
        q = request.GET['q']
        if not q:
            error = True
        else:
            books = Book.objects.filter(title__icontains=q)
            return render_to_response('search_results.html',
                {'books': books, 'query': q})
    return render_to_response('search_form.html',
        {'error': error})</code><p>با تغییر فوق، در صورتیکه یک کاربر آدرس /search/ را با هیچ پارامتر GET ای بازدید کند، فرم جستجو را با هیچ پیام خطایی مشاهده خواهد کرد. در صورتیکه یک کاربر فرم را با یک مقدار خالی برای 'q' ارسال کند، صفحه ی جستجو را با یک پیام خطا مشاهده خواهد کرد. و در پایان، در صورتیکه یک کاربر فرم را به یک مقدار پر برای 'q' اراسل کند، نتایج جستجو در پایگاه داده را مشاده خواهد کرد.</p>
<p>می توان یک اصلاح پایانی جهت حذف یک قسمت زائد برای برنامه ی فوق ایجاد نمود. اکنون که دو view و آدرس را یکی شد و /search/ هر دوی نمایش فرم جستجو و نمایش نتیجه را کنترل می کند، فرم HTML در search_form.html نباید یک آدرس مستقیم داشته باشد. بجای کد زیر:</p>
<code class="language-html">&lt;form action="/search/" method="get"&gt;</code><p>می توان بدین شکل عمل کرد:</p>
<code class="language-html">&lt;form action="" method="get"&gt;</code><p><bdo class="leftInline">action=""</bdo> یعنی "فرم را به آدرس همین صفحه ی فعلی ارسال کن." با تغییر فوق در اینجا، در صورتیکه همیشه تابع <bdo class="leftInline">search()</bdo> را به آدرس دیگر ارسال می کرده اید، دیگر لازم نیست تغییر دادن action را بیاد بیاورید.</p>
<h3>تایید اعتبار آسان</h3>
<p>مثال جستجوی بخش قبلی از نظر منطقی هنوز هم ساده است، مخصوصا در مورد تایید اعتبار داده؛ تنها اطمینان حاصل شد که مقدار ارسالی خالی نباشد. بسیاری از فرم های HTML حاوی یک سطح تایید اعتبار می باشند که پیچیده تر از اطمینان حاصل کردن از مقدار غیر خالی است. همه ی پیام های خطایی به این شکل درون وب دیده ایم:</p>
<ul>
<li>"لطفا یک آدرس الکترونیکی معتبر وارد کنید. 'foo' یک آدرس پست الکترونیکی نیست."</li>
<li>"لطفا یک کد پستی پنج رقمی معتبر وارد کنید. <bdo class="leftInline">'123'</bdo> پست الکترونیکی نیست."</li>
<li>"لطفا یک تاریخ معتبر با قالب بندی YYYY-MM-DD وارد کنید."</li>
<li>لطفا رمز عبوری وارد کنید که حداقل هشت حرف داشته و حاوی حداقل یک عدد باشد.</li>
</ul>
<ul>
<img src="https://amoozesh.org/static/img/note.svg" alt="جدول" class="yaddasht"><h4>یک نکته در تایید اعتبار جاوا اسکریپت</h4>
<p>این موضوع خارج از حوصله ی این کتاب می باشد، ولی می توان از جاوا اسکریپت برای تایید اعتبار داده در سمت کلاینت به طور مستقیم در مرورگر استفاده کرد. اما آگاه باشید: حتی اگر این کار انجام دهید، باید در سمت سرور نیز داده را تایید اعتبار کنید. برخی افراد جاوا اسکریپت را خاموش می کنند، و برخی کاربران مخرب ممکن است برخی داده های غیر معتبر را برای مشاهده ی اینکه آیا می توانند تخریبی ایجاد کنند یا خیر درون کنترل کننده ی فرم ارسال می کنند.</p>
<p>هیچ کاری نمی توانید انجام دهید، غیر از اینکه همواره داده های ارسالی از سمت کاربر را در سمت سرور (مانند view های جنگو) تایید اعتبار کنید. باید اینگونه تصور کرد که تایید اعتبار جاوا اسکریپت نوعی ویژگی قابل استفاده اضافی می باشد، نه تنها به معنی یک تایید اعتبار.</p>
</ul>
<p>اجازه دهید view قبلی یعنی <bdo class="leftInline">search()</bdo> را کمی پیچیده کنیم، به طوری که کاربر تنها بتواند داده ی ورودی برای جستجو را کمتر یا مساوی با بیست حرف وارد کند. (برای مثال، می توان این چنین گفت که هر چیزی طولانی تر مقدار گفته شده می تواند باعث کندی جستجو شود.) چه طور می توان آن را انجام داد؟ ساده ترین روش ممکن است قرار دادن منطق مورد نظر به طور مستقیم درون view می باشد، مانند زیر:</p>
<code class="language-python">def search(request):
    error = False
    if 'q' in request.GET:
        q = request.GET['q']
        if not q:
            error = True
        elif len(q) &gt; 20:
            error = True
        else:
            books = Book.objects.filter(title__icontains=q)
            return render_to_response('search_results.html',
                {'books': books, 'query': q})
    return render_to_response('search_form.html',
        {'error': error})</code><p>حالا، در صورتیکه سعی کنید یک داده را برای جستجو با بیشتر از بیست حرف ارسال کنید، اجازه ی جستجو داده نخواهد شد؛ یک پیام خطا دریافت خواهید کرد. ولی پیام خطا در search_form.html در حال حاضر <bdo class="leftInline">"Please submit a search term."</bdo> می باشد. – بنابراین باید طوری آن را تغییر داد که برای هر دو مورد صحیح باشد:</p>
<code class="language-django">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Search&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    {% if error %}
        &lt;p style="color: red;"&gt;Please submit a search term 20 characters or shorter.&lt;/p&gt;
    {% endif %}
    &lt;form action="/search/" method="get"&gt;
        &lt;input type="text" name="q"&gt;
        &lt;input type="submit" value="Search"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><p>در کد فوق نکته ای غیر زیبا وجود دارد. پیام خطای واحد برای همه کمی گیج کننده است. چرا باید پیام خطا برای یک فرم خالی ارسالی محدودیت بیست حرف را بیان کند؟ پیام خطا باید خاص، غیر مبهم بوده و گیج کننده نباشد.</p>
<p>در واقع مشکل آن است که از یک مقدار Boolean سایده برای خطا استفاده شده است، در حالیکه باید از یک لیست رشته های پیام خطا استفاده شود، در زیر نحوه ی حل این مشکل نشان داده شده است:</p>
<code class="language-python">def search(request):
    errors = []
    if 'q' in request.GET:
        q = request.GET['q']
        if not q:
            errors.append('Enter a search term.')
        elif len(q) &gt; 20:
            errors.append('Please enter at most 20 characters.')
        else:
            books = Book.objects.filter(title__icontains=q)
            return render_to_response('search_results.html',
                {'books': books, 'query': q})
    return render_to_response('search_form.html',
        {'errors': errors})</code><p>سپس نیاز به ایجاد یک پیچیدگی کوچک درون فایل search_form.html برای بیان اینکه بجای یک مقدار Boolean یک لیست از error ها ارسال شده است.</p>
<code class="language-django">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Search&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    {% if errors %}
        &lt;ul&gt;
            {% for error in errors %}
            &lt;li&gt;{{ error }}&lt;/li&gt;
            {% endfor %}
        &lt;/ul&gt;
    {% endif %}
    &lt;form action="/search/" method="get"&gt;
        &lt;input type="text" name="q"&gt;
        &lt;input type="submit" value="Search"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><h3>ساخت یک فرم تماس</h3>
<p>اگرچه در سرتاسر مثال فرم جستجوی کتاب بررسی کرده و به طور ظریف آن را اصلاح نمودیم، ولی اساسا هنوز این مثال ساده می باشد: زیرا تنها دارای یک فیلد 'q' می باشد. به دلیل سادگی بیش از حد مثال مذکور حتی از کتابخانه ی فرم جنگو برای آن استفاده ای نشد. ولی فرم های پیچیده تر برای رفتار پیچیده تر فراخوانی می شوند – و حالا، چیزی پیچده تر را توسعه خواهیم داد: یک سایت فرم تماس.</p>
<p>این مثال یک فرم خواهد بود که به کاربران سایت اجازه اصلاح و وارد کردن اطلاعات را به همراه یک فیلد اختیاری آدرس پست الکترونیکی می دهد. بعد از آنکه فرم ارسال و داده تایید اعتبار شد، به طور خودکار یک پیام از طریق آدرس پست الکترونیک به کارمندان سایت ارسال خواهد شد.</p>
<p>با template مورد نظر contact_form.html شروع می کنیم:</p>
<code class="language-django">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Contact us&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Contact us&lt;/h1&gt;

    {% if errors %}
        &lt;ul&gt;
            {% for error in errors %}
            &lt;li&gt;{{ error }}&lt;/li&gt;
            {% endfor %}
        &lt;/ul&gt;
    {% endif %}

    &lt;form action="/contact/" method="post"&gt;
        &lt;p&gt;Subject: &lt;input type="text" name="subject"&gt;&lt;/p&gt;
        &lt;p&gt;Your e-mail (optional): &lt;input type="text" name="email"&gt;&lt;/p&gt;
        &lt;p&gt;Message: &lt;textarea name="message" rows="10" cols="50"&gt;&lt;/textarea&gt;&lt;/p&gt;
        &lt;input type="submit" value="Submit"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><p>سه فیلد تعریف شده است: موضوع، آدرس پست الکترونیک و پیام. دومین فیلد اختیاری می باشد، ولی دو فیلد دیگر الزاما باید پر شوند. توجه داشته باشید که به جای <bdo class="leftInline">method="get"</bdo> در اینجا از <bdo class="leftInline">method="POST"</bdo> استفاده شده است، زیرا ارسال فرم ممکن است دارای یک اثر زیان بار باشد – فرستادن یک پست الکترونیکی. همچنین، کد نمایش خطا از template قبلی search_form.html کپی شده است.</p>
<p>در صورتیکه کار را با view بخش قبلی <bdo class="leftInline">search()</bdo> ادامه دهیم، یک نسخه ی خام از <bdo class="leftInline">contact()</bdo> ممکن است چیزی شبیه به کد زیر باشد:</p>
<code class="language-python">from django.core.mail import send_mail
from django.http import HttpResponseRedirect
from django.shortcuts import render_to_response

def contact(request):
    errors = []
    if request.method == 'POST':
        if not request.POST.get('subject', ''):
            errors.append('Enter a subject.')
        if not request.POST.get('message', ''):
            errors.append('Enter a message.')
        if request.POST.get('email') and '@' not in request.POST['email']:
            errors.append('Enter a valid e-mail address.')
        if not errors:
            send_mail(
                request.POST['subject'],
                request.POST['message'],
                request.POST.get('email', 'noreply@example.com'),
                ['siteowner@example.com'],
            )
            return HttpResponseRedirect('/contact/thanks/')
    return render_to_response('contact_form.html',
        {'errors': errors})</code><p>(در صورتیکه مثال های کتاب را دنبال می کنید، ممکن است مردد باشید که آیا view فوق را درون فایل books/views.py قرار دهید یا خیر. کد فوق هیچ کاری با برنامه ی books انجام نمی دهد، بنابراین آیا می توان جای دیگری آن را قرار داد؟ این کاملا به تصمیم شما بستگی دارد؛ جنگو هیچ توجهی به این موضوع ندارد، البته تا زمانیکه شما درون URLconf به درستی به view مورد نظر اشاره کنید. ترجیح شخصی ما بر این است که یک دایرکتوری جدا به نام contact هم سطح با دایرکتوری books بسازید. این دایرکتوری یک <bdo class="leftInline">__init__.py</bdo> و views.py خواهد داشت.)</p>
<p>چند نکته ی جدید که در مثال فوق اتفاق افتاده است:</p>
<ul>
<li>بررسی شده است که request.method مقدار 'POST' باشد. تنها در صورتیکه فرم ارسال شده باشد مقدار آن True خواهد بود؛ در صورتیکه شخصی تنها فرم تماس را مشاهده کند مقدار آن True نخواهد بود. (در مورد مشاهده ی فرم تماس request.method مقدار 'GET' خواهد داشت، زیرا در حالت عادی جستجو در وب، مرورگرها از GET استفاده می کنند نه از POST. این حالت روش زیبایی را برای مجزا کردن مورد نمایش فرم از مورد پردازش فرم ایجاد می کند.)</li>
<li>بجای request.GET، برای دسترسی به داده های ارسال شده ی فرم از request.POST استفاده شده است. این حرکت بسیار ضروری می باشد، زیرا تگ &lt;form&gt; در contact_form.html از <bdo class="leftInline">method="post"</bdo> استفاده کرده است. در صورتیکه view از طریق POST قابل دسترسی باشد، بنابراین request.GET خالی خواهد بود.</li>
<li>در مثال فوق، دو فیلد subject و message به صورت الزامی وجود دارد، بنابراین باید هر دوی آن ها تایید اعتبار شوند، توجه داشته باشید که به جای <bdo class="leftInline">request.POST[]</bdo> از <bdo class="leftInline">request.POST.get()</bdo> استفاده شده است، هنگام استفاده از <bdo class="leftInline">request.POST[]</bdo> در صورتیکه کلید مورد نظر وجود نداشته باشد موجب بروز خطای MultiValueDictKeyError خواهد شد، برای جلوگیری از بروز خطا در صورت نبود کلید از <bdo class="leftInline">request.POST.get()</bdo> استفاده شده است که آرگومان دوم مقدار پیشفرضی می باشد که در صورت نبود کلید این مقدار برگردانده می شود.</li>
<li>اگرچه فیلد email یک فیلد الزامی نمی باشد، ولی در صورت وارد کردن مقداری برای این فیلد تایید اعتبار شده است. الگوریم تایید اعتبار در اینجا بسیار شکننده است، زیرا تنها بررسی شده است که رشته ی مورد نظر حاوی علامت (@) باشد. در دنیای واقعی، شما تایید اعتبارهایی قویتر نیاز دارید (جنگو همچنین تایید اعتباری را ارائه کرده است، که کمی بعد توضیح داده خواهد شد.)</li>
<li>از تابع django.core.mail.send_mail برای فرستادن یک پست الکترونیکی استفاده شده است. این تابع دارای چهار آرگومان الزامی می باشد: موضوع پست الکترونیکی، بدنه ی پست الکترونیکی، آدرس فرستنده و یک لیستی از آدرس های گیرندگان. send_mail یک wrapper مناسب در اطراف کلاس EmailMessage می باشد، که ویژگی های پیشرفته ای مانند ضمیمه ها (attachments)، پست های الکترونیک چند قسمتی و کنترل کامل سرتاسر header های پست الکترونیک را ارائه می دهد.<p>توجه داشته باشید که به منظور فرستاند پست الکترونیک با استفاده از <bdo class="leftInline">send_mail()</bdo>، سرور شما باید برای فرستاده mail، پیکربندی شده باشد و همچنین تنظیمات خاصی برای این منظور نیز لازم می باشد که برای اطلاعات بیشتر در این باره می توانید به آدرس <a title="django Sending email" href="http://docs.djangoproject.com/en/dev/topics/email" class="content">Sending email</a> مراجعه کنید.</p>
</li>
<li>بعد از فرستادن پست الکترونیک، با برگرداند یک شیء HttpResponseRedirect به یک صفحه ی "success" تغییر مسیر داده شده است. ولی باید دلیل استفاده از redirect را به جای برای مثال <bdo class="leftInline">render_to_response()</bdo> را توضیح دهیم.<p>دلیل: در صورتیکه یک کاربر دکمه ی "Refresh" را در آن صفحه ای که از طریق روش POST بارگذاری شده است فشار دهد، آن درخواست تکرار خواهد شد. این می تواند اغلب باعث بروز رفتاری ناخواسته شود، مانند اضافه شدن چندین بار یک رکورد تکراری در پایگاه داده – یا در مثال فوق، پست الکترونیکی دوباره فرستاده می شود. در صورتیکه کاربر بعد از POST به صفحه ی دیگری redirect شود، بنابراین هیچ شانسی برای تکرار شدن درخواست وجود ندارد.</p>
<p>شما باید همواره یک redirect برای نتایج POST موفقیت آمیز ایجاد کنید.</p>
</li>
</ul>
<p>view فوق کار می کند، ولی توابع تایید اعتبار از توع ضعیفی می باشند. پردازش کردن یک فرم با ده ها فیلد را تصور کنید؛ آیا واقعا می خواهید برای همه ی آن ها عبارت های if بنویسید؟</p>
<p>مشکل دیگر نمایش دوباره ی فرم می باشد. در زمان ایجاد خطاهای اعتبار، بهترین تمرین نمایش دوباره ی فرم با داده های قبلی ارسال شده می باشد، به طوری که کاربر بتواند چیزی را که به طور اشتباه پر کرده است را مشاهده کند (و همچنین کاربر نیازی به دوباره پر کردن فیلدهایی که درست بوده اند پیدا نکند). می توان به صورت دستی داده های POST را به به سمت template پس فرستاد، ولی لازم است هر فیلد HTML را برای درج کردن مقدار مناسب در مکان مناسب ویرایش کرد:</p>
<code class="language-python"># views.py

def contact(request):
    errors = []
    if request.method == 'POST':
        if not request.POST.get('subject', ''):
            errors.append('Enter a subject.')
        if not request.POST.get('message', ''):
            errors.append('Enter a message.')
        if request.POST.get('email') and '@' not in request.POST['email']:
            errors.append('Enter a valid e-mail address.')
        if not errors:
            send_mail(
                request.POST['subject'],
                request.POST['message'],
                request.POST.get('email', 'noreply@example.com'),
                ['siteowner@example.com'],
            )
            return HttpResponseRedirect('/contact/thanks/')
    return render_to_response('contact_form.html', {
        'errors': errors,
        'subject': request.POST.get('subject', ''),
        'message': request.POST.get('message', ''),
        'email': request.POST.get('email', ''),
    })

# contact_form.html

&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Contact us&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Contact us&lt;/h1&gt;

    {% if errors %}
        &lt;ul&gt;
            {% for error in errors %}
            &lt;li&gt;{{ error }}&lt;/li&gt;
            {% endfor %}
        &lt;/ul&gt;
    {% endif %}

    &lt;form action="/contact/" method="post"&gt;
        &lt;p&gt;Subject: &lt;input type="text" name="subject" value="{{ subject }}"&gt;&lt;/p&gt;
        &lt;p&gt;Your e-mail (optional): &lt;input type="text" name="email" value="{{ email }}"&gt;&lt;/p&gt;
        &lt;p&gt;Message: &lt;textarea name="message" rows="10" cols="50"&gt;**{{ message }}**&lt;/textarea&gt;&lt;/p&gt;
        &lt;input type="submit" value="Submit"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><p>کد فوق بسیار ضعیف و غیر ضروری می باشد، و فرصت های زیادی را برای خطاهای فردی را ایجاد می کند. </p>
<h3>اولین کلاس Form</h3>
<p>جنگو دارای یک کتابخانه ی فرم با نام django.forms می باشد، که بسیاری از مسائل بررسی شده در این فصل را کنترل می کند – از نمایش فرم تا تایید اعتبار. اجازه دهید برنامه ی فرم تماس را با استفاده از فرم فریم ورک یا چارچوب جنگو دوباره بنویسیم.</p>
<ul>
<img src="https://amoozesh.org/static/img/note.svg" alt="جدول" class="yaddasht"><h4>کتابخانه ی "newforms" جنگو</h4>
<p>ممکن است تاکنون چیزی درباره ی django.newforms شنیده باشید. هنگامی که درباره ی django.newforms صحبت می شود، صحبت درباره ی چیزی است که حالا django.forms نام دارد – که در این فصل به پرداخته شده است.</p>
<p>دلیل تغییر نام این کتابخانه تاریخی می باشد. هنگامی که جنگو برای عموم منتشر شد، دارای سیستم فرم های پیچیده و گیج کننده به نام django.forms بود. این کتابخانه دوباره به صورت کامل بازنویسی شد، و نسخه ی جدید django.newforms نامیده شد به طوری که افراد هنوز می توانستند از نسخه ی قدیمی استفاده کنند. هنگامی که جنگو <bdo class="leftInline">1.0</bdo> منتشر شد، django.forms کنار گذاشته شد، و django.newforms به django.forms تغییر نام داد.</p>
</ul>
<p>روش اصلی برای استفاده از فریم ورک یا چارچوب فرم ها تعریف یک کلاس Form برای هر <bdo class="leftInline">&lt;form&gt; HTML</bdo> می باشد که با آن سرکار دارید. در مثال ما، تنها یک &lt;form&gt; داریم، بنابراین یک کلاس Form هم خواهیم داشت. این کلاس می تواند در هرجایی که می خواهید قرار بگیرد – حتی به طور مستقیم درون فایل views.py – ولی مانند یک قرارداد کلاس های Form درون یک فایل جدا به نام forms.py قرار می گیرند. این فایل را در مسیر فایل views.py بسازید، و کد زیر را درون آن وارد کنید:</p>
<code class="language-python">from django import forms

class ContactForm(forms.Form):
    subject = forms.CharField()
    email = forms.EmailField(required=False)
    message = forms.CharField()</code><p>کد فوق همانند مدل های جنگو می باشد. هر فیلد در فرم با یک نوع از کلاس فیلد – CharField و EmailField نوع هایی هستند که در کد فوق استفاده شده اند – به صورت attribute های کلاس Form نشان داده می شود. هر فیلد به صورت پیشفرض الزامی (required) می باشد، بنابراین برای اختیاری کردن فیلد email، required=False تعیین شده است.</p>
<p>اجازه دهید از طریق interactive interpreter پایتون کاری را که این کلاس انجام می دهد را با هم مشاهده کنیم، اولین کاری که می تواند انجام دهد نمایش خودش به صورت HTML می باشد:</p>
<code class="language-python">&gt;&gt;&gt; from contact.forms import ContactForm
&gt;&gt;&gt; f = ContactForm()
&gt;&gt;&gt; print f
&lt;tr&gt;&lt;th&gt;&lt;label for="id_subject"&gt;Subject:&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input type="text" name="subject" id="id_subject" /&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;th&gt;&lt;label for="id_email"&gt;Email:&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input type="text" name="email" id="id_email" /&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;th&gt;&lt;label for="id_message"&gt;Message:&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input type="text" name="message" id="id_message" /&gt;&lt;/td&gt;&lt;/tr&gt;</code><p>جنگو یک label برای هر فیلد اضافه کرده است. هدف ایجاد رفتار تا حد ممکن بهینه به طور پیشفرض می باشد. </p>
<p>کد فوق خروجی پیشفرض در قالب بندی <bdo class="leftInline">&lt;table&gt; HTML</bdo> می باشد، ولی خروجی های داخلی دیگری نیز وجود دارند:</p>
<code class="language-python">&gt;&gt;&gt; print f.as_ul()
&lt;li&gt;&lt;label for="id_subject"&gt;Subject:&lt;/label&gt; &lt;input type="text" name="subject" id="id_subject" /&gt;&lt;/li&gt;
&lt;li&gt;&lt;label for="id_email"&gt;Email:&lt;/label&gt; &lt;input type="text" name="email" id="id_email" /&gt;&lt;/li&gt;
&lt;li&gt;&lt;label for="id_message"&gt;Message:&lt;/label&gt; &lt;input type="text" name="message" id="id_message" /&gt;&lt;/li&gt;
&gt;&gt;&gt; print f.as_p()
&lt;p&gt;&lt;label for="id_subject"&gt;Subject:&lt;/label&gt; &lt;input type="text" name="subject" id="id_subject" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;label for="id_email"&gt;Email:&lt;/label&gt; &lt;input type="text" name="email" id="id_email" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;label for="id_message"&gt;Message:&lt;/label&gt; &lt;input type="text" name="message" id="id_message" /&gt;&lt;/</code><p>توجه داشته باشید که تگ های باز و بسته ی &lt;table&gt;، &lt;ul&gt; و &lt;form&gt; درون خروجی وجود ندارند، به طوری که می توان هر ردیف اضافه ای را در صورت نیاز اضافه کرد.</p>
<p>این متدها تنها میانبرهای برای موارد رایج نمایش تمام فرم می باشند. همچنین می توان برای هر فیلد خاص نیز فرم را نمایش داد:</p>
<code class="language-python">&gt;&gt;&gt; print f['subject']
&lt;input type="text" name="subject" id="id_subject" /&gt;
&gt;&gt;&gt; print f['message']
&lt;input type="text" name="message" id="id_message" /&gt;</code><p>دومین کاری که شیء های Form می توانند انجام دهند تایید اعتبار داده می باشد. برای تایید اعتبار داده، یک شیء Form جدید ایجاد کرده و یک دیکشنری از داده هایی که نام فیلد را به داده ی مورد نظر مربوط می کند به آن ارسال کنید.</p>
<code class="language-python">&gt;&gt;&gt; f = ContactForm({'subject': 'Hello', 'email': 'adrian@example.com', 'message': 'Nice site!'})</code><p>هنگامی که داده ها را با نمونه ی Form مربوط ساختید، شما یک "bound" فرم ساخته اید:</p>
<code class="language-python">&gt;&gt;&gt; f.is_bound
True</code><p>متد <bdo class="leftInline">is_valid()</bdo> را روی هر bound Form برای یافتن اینکه داده معتبر است یا خیر فراخوانی کنید. ما برای هر فیلد یک مثدار معتبر ارسال کردیم، بنابراین Form به کلی معتبر می باشد:</p>
<code class="language-python">&gt;&gt;&gt; f.is_valid()
True</code><p>در صورتیکه فیلد email را ارسال نکنیم، همچنان معتبر خواهد ماند، زیرا این فیلد را به صورت required=False تعیین کرده ایم:</p>
<code class="language-python">&gt;&gt;&gt; f = ContactForm({'subject': 'Hello', 'message': 'Nice site!'})
&gt;&gt;&gt; f.is_valid()
True</code><p>ولی، در صورتیکه subject یا message را در نظر نگیریم، فرم دیگر معتبر نخواهد بود:</p>
<code class="language-python">&gt;&gt;&gt; f = ContactForm({'subject': 'Hello'})
&gt;&gt;&gt; f.is_valid()
False
&gt;&gt;&gt; f = ContactForm({'subject': 'Hello', 'message': ''})
&gt;&gt;&gt; f.is_valid()
False</code><p>می توان اطلاعات بیشتری را از طریق پیام های خطا بدست آورد:</p>
<code class="language-python">&gt;&gt;&gt; f = ContactForm({'subject': 'Hello', 'message': ''})
&gt;&gt;&gt; f['message'].errors
[u'This field is required.']
&gt;&gt;&gt; f['subject'].errors
[]
&gt;&gt;&gt; f['email'].errors
[]</code><p>هر نمونه ی bound Form دارای attribute های خطا می باشد که یک دیکشنری با نام فیلد های مرتبط شده با لیست های پیام خطا ارائه می دهد:</p>
<code class="language-python">&gt;&gt;&gt; f = ContactForm({'subject': 'Hello', 'message': ''})
&gt;&gt;&gt; f.errors
{'message': [u'This field is required.']}</code><p>در پایان، برای نمونه هایی Form ای که دارای داده های معتبر می باشند، یک attribute با نام cleaned_data در دسترس می باشد. این attribute یک دشکنری از داده های ارسال (submit) شده می باشد. فریم ورک یا چارچوب فرم جنگو نه تنها داده را تایید اعتبار می کند، بلکه آن را به یک نوع مناسب پایتون تبدیل می کند.</p>
<code class="language-python">&gt;&gt;&gt; f = ContactForm({'subject': 'Hello', 'email': 'adrian@example.com', 'message': 'Nice site!'})
&gt;&gt;&gt; f.is_valid()
True
&gt;&gt;&gt; f.cleaned_data
{'message': u'Nice site!', 'email': u'adrian@example.com', 'subject': u'Hello'}</code><p>فرم تماس ما تنها با رشته ها سر کار دارد که به شیء های یونیکد تبدیل شده اند – ولی در صورتیکه از یک IntegerField یا dateField استفاده کنیم، فریم ورک یا چارچوب فرم از شیء های مناسب integer یا datetime.date برای فیلد داده شده استفاده خواهد کرد.</p>
<h3>استفاده کردن از شیء های فرم درون view</h3>
<p>در زیر نحوه ی استفاده از کلاس های فرم به جای روش قبلی را مشاهده خواهید کرد:</p>
<code class="language-python"># views.py

from django.shortcuts import render_to_response
from mysite.contact.forms import ContactForm

def contact(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            cd = form.cleaned_data
            send_mail(
                cd['subject'],
                cd['message'],
                cd.get('email', 'noreply@example.com'),
                ['siteowner@example.com'],
            )
            return HttpResponseRedirect('/contact/thanks/')
    else:
        form = ContactForm()
    return render_to_response('contact_form.html', {'form': form})

# contact_form.html

&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Contact us&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Contact us&lt;/h1&gt;

    {% if form.errors %}
        &lt;p style="color: red;"&gt;
            Please correct the error{{ form.errors|pluralize }} below.
        &lt;/p&gt;
    {% endif %}

    &lt;form action="" method="post"&gt;
        &lt;table&gt;
            {{ form.as_table }}
        &lt;/table&gt;
        &lt;input type="submit" value="Submit"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><p>نگاه کنید که تا چه مقدار قادر به حذف کردن کدهای اضافه ی قبلی می باشیم! فریم ورک یا چارچوب فرم جنگو نمایش HTML، تایید اعتبار، تبدیل داده ها و نمایش دوباره ی فرم با خطاها را کنترل می کند.</p>
<p>سعی کنید به صورت محلی روش فوق را امتحان کنید، با فیلدها خالی فرم را ارسال کنید، با فیلد نا معتبر برای email فرم را ارسال کنید، و در پایان فرم را با داده ی معتبر ارسال کنید. (البته بسته پیکربندی mail-server، ممکن است هنگام فراخوانی <bdo class="leftInline">send_mail()</bdo> دریافت کنید، که بحث آن جدا می باشد.)</p>
<h3>تغییر نحوه ی ارائه ی فیلدها</h3>
<p>ممکن است اولین چیزی که مورد توجه شما قرار گیرد این باشد که فیلد message به صورت <bdo class="leftInline">&lt;input type="text"&gt;</bdo> نمایش داده شده است، و باید یک &lt;textarea&gt; باشد. می توان این مشکل را به شکل زیر حل کرد:</p>
<code class="language-python">from django import forms

class ContactForm(forms.Form):
    subject = forms.CharField()
    email = forms.EmailField(required=False)
    message = forms.CharField(widget=forms.Textarea)</code><p>هر نوع فیلد دارای حالت پیشفرض خود می باشد، ولی می توان به سادگی این پیشفرض را تغییر داد، یا یک حالت مورد دلخواه را ایجاد نمود.</p>
<p>Think of the Field classes as representing validation logic, while widgets represent presentation logic.</p>
<h4>تنظیم حداکثر طول</h4>
<p>یک از رایج ترین نیازهای تایید اعتبار بررسی اندازه ی قطعی یک فیلد می باشد. برای اندازه گیری خوب، باید کلاس ContactForm را محدود به subject ای با صد حرف کرد. برای انجام چنین کاری، تنها یک max_length برای CharField قرار می دهیم:</p>
<code class="language-python">from django import forms

class ContactForm(forms.Form):
    subject = forms.CharField(max_length=100)
    email = forms.EmailField(required=False)
    message = forms.CharField(widget=forms.Textarea)</code><p>همچنین یک آرگومان اختیاری min_length نیز در دسترس می باشد.</p>
<h4>تنظیم مقدار اولیه</h4>
<p>به منظور بهبود این فرم، اجازه دهید یک مقدار اولیه برای فیلد subject اضافه کنیم: "I love your site". برای انجام چنین کاری می توان از آرگومان initial هنگامی که یک نمونه Form را می سازیم استفاده کرد.</p>
<code class="language-python">def contact(request):
    if request.method == 'POST':
        form = ContactForm(request.POST)
        if form.is_valid():
            cd = form.cleaned_data
            send_mail(
                cd['subject'],
                cd['message'],
                cd.get('email', 'noreply@example.com'),
                ['siteowner@example.com'],
            )
            return HttpResponseRedirect('/contact/thanks/')
    else:
        form = ContactForm(
            initial={'subject': 'I love your site!'}
        )
    return render_to_response('contact_form.html', {'form': form})</code><p>حالا، فیلد subject با مقدار از پیش پر شده ی مورد نظر نمایش داده خواهد شد.</p>
<h3>سفارشی کردن قوانین تایید اعتبار</h3>
<p>تصور کنید یک فرم را برای پست الکترونیک راه اندازی کرده اید. ولی یک مشکلی وجود دارد: برخی از پیام های ارسال شده دارای تنها یک یا دو کلمه می باشند، که برای فهمیدن موضوع کافی نمی باشد. در این مورد تصمیم می گیرید یک روش تایید اعتبار جدید را برگزینید: لطفا چهار کلمه یا بیشتر.</p>
<p>تعدادی روش برای سفارشی ساختن تایید اعتبار فرم جنگو وجود دارد. در صورتیکه قانون جدید چیزی باشد که از آن همواره استفاده می کنیم، می توان یک نوع فیلد سفارشی ساخت. </p>
<p>می خواهیم یک تایید اعتبار اضافه در فیلد message ایجاد کنیم، بنابراین یک متد <bdo class="leftInline">clean_message()</bdo> به کلاس فرم خود اضافه می کنیم:</p>
<code class="language-python">from django import forms

class ContactForm(forms.Form):
    subject = forms.CharField(max_length=100)
    email = forms.EmailField(required=False)
    message = forms.CharField(widget=forms.Textarea)

    def clean_message(self):
        message = self.cleaned_data['message']
        num_words = len(message.split())
        if num_words &lt; 4:
            raise forms.ValidationError("Not enough words!")
        return message</code><p>سیستم فرم جنگو به طور خودکار هر متدی را که با <bdo class="leftInline">clean_</bdo> شروع و با نام یک فیلد تمام شود جستجو می کند. در صورتیکه همچین متدی وجود داشته باشد، در مدت تایید اعتبار فراخوانی خواهد شد.</p>
<p>به طور خاص، متد <bdo class="leftInline">clean_message()</bdo> بعد از تایید اعتبار منطقی پیشفرض برای فیلد داده شده فراخوانی می شود (در این مورد، تایید اعتبار منطقی برای یک CharField الزامی، می باشد.) زیرا داده ی فیلد در اینصورت تا حدی پردازش شده خواهد بود، این داده ی پردازش شده را از self.cleaned_data بدست می آوریم. همچنین، در این صورت لازم نیست درباره ی بررسی کردن اینکه مقدار وجود دارد و خالی نمی باشد نگران باشیم؛ این کار با تایید کننده ی اعتبار پیشفرض انجام شده است.</p>
<p>بسادگی از ترکیب <bdo class="leftInline">len()</bdo> و <bdo class="leftInline">split()</bdo> برای شمارش کلمات استفاده کرده ایم. در صورتیکه کاربر کلمات کمی وارد کند، خطای forms.ValidationError ایجاد خواهد شد. رشته ی اضافه شده به این خطا به صورت یک آیتم اضافه شده به لیست خطاها به کاربر نمایش داده خواهد شد.</p>
<p>مهم است که به طور صریح یک مقدار تمیز شده (cleaned) برای فیلد در پایان متد برگردانده شده است. این کار به ما اجازه می دهد مقدار را درون متد تایید اعتبار سفارشی خودمان تغییر دهیم (یا به نوع های دیگر پایتون تبدیل کنیم).</p>
<h4>تعیین label ها</h4>
<p>به طور پیشفرض، label ها در در جنگو به طور خودکار از طریق جا به جا کردن خط تیره با فاصله و همچنین تبدیل حرف اول به حرف بزرگ ساخته می شوند – بنابراین label برای فیلد email به این شکل خواهد بود: "Email". (این روش آشنا نیست؟ این الگوریتم همان الگوریتمی می باشد که مدل های جنگو از آن برای محاسبه ی مقدار پیشفرض verbose_name برای فیلدها از آن استفاده می کردند که در <a href="https://amoozesh.org/django/model/" class="content" title="مدل">آموزش مدل جنگو</a> توضیح داده شده است.)</p>
<p>ولی، همانند مدل های جنگو، می توان label فیلد داده شده را سفارشی کرد. تنها کافیست مانند زیر از label استفاده شود:</p>
<code class="language-python">class ContactForm(forms.Form):
    subject = forms.CharField(max_length=100)
    email = forms.EmailField(required=False, label='Your e-mail address')
    message = forms.CharField(widget=forms.Textarea)</code><h3>سفارشی کردن طرح فرم</h3>
<p>template ما یعنی contact_form.html از <bdo class="leftInline">{{ form.as_table }}</bdo> برای نمایش فرم استفاده کرده است، ولی می توان فرم را به روش های دیگری نیز برای کنترل ذره به ذره نمایش داد.</p>
<p>سریع ترین روش برای سفارشی کردن نمایش فرم ها استفاده از CSS می باشد. تولید کننده ی خودکار لیست های خطا دقیقا از <bdo class="leftInline">&lt;ul class="errorlist"&gt;</bdo> استفاده می کنند به طوری که می توان با استفاده از CSS آن ها را علامت گذاری کرد:</p>
<code class="language-css">&lt;style type="text/css"&gt;
    ul.errorlist {
        margin: 0;
        padding: 0;
    }
    .errorlist li {
        background-color: red;
        color: white;
        display: block;
        font-size: 10px;
        margin: 0 0 3px;
        padding: 4px 5px;
    }
&lt;/style&gt;</code><p>زمانی این روش مناسب می باشد که بخواهیم حالت پیشفرض ارائه شده را تغییر دهیم. <bdo class="leftInline">{{ form.as_table }}</bdo> و ... میانبرهای مفیدی برای توسعه ی برنامه می باشند، ولی هرچیزی درباره ی روش نمایش یک فرم می تواند غالبا درون خود template دوباره نویسی شده و تغییر کند، و شما احتمالا انجام اینکار را برای خودتان خواهید یافت. </p>
<p>هر فیلدی (<bdo class="leftInline">&lt;input type="text"&gt;</bdo>، <bdo class="leftInline">&lt;select&gt;</bdo>، <bdo class="leftInline">&lt;textarea&gt;</bdo> و ...) می تواند به صورت جداگانه با دسترسی داشتن به <bdo class="leftInline">{{ form.fieldname }}</bdo> در template ارائه شده باشد، و هر خطای مربوط به آن با یک فیلد به صورت <bdo class="leftInline">{{ form.fieldname.errors }}</bdo> قابل دسترسی می باشد. با در نظر گرفتن نکات فوق، می توان یک template سفارشی برای فرم تماس با کد زیر ایجاد نمود:</p>
<code class="language-django">&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Contact us&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Contact us&lt;/h1&gt;

    {% if form.errors %}
        &lt;p style="color: red;"&gt;
            Please correct the error{{ form.errors|pluralize }} below.
        &lt;/p&gt;
    {% endif %}

    &lt;form action="" method="post"&gt;
        &lt;div class="field"&gt;
            {{ form.subject.errors }}
            &lt;label for="id_subject"&gt;Subject:&lt;/label&gt;
            {{ form.subject }}
        &lt;/div&gt;
        &lt;div class="field"&gt;
            {{ form.email.errors }}
            &lt;label for="id_email"&gt;Your e-mail address:&lt;/label&gt;
            {{ form.email }}
        &lt;/div&gt;
        &lt;div class="field"&gt;
            {{ form.message.errors }}
            &lt;label for="id_message"&gt;Message:&lt;/label&gt;
            {{ form.message }}
        &lt;/div&gt;
        &lt;input type="submit" value="Submit"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code><p><bdo class="leftInline">{{ form.message.errors }}</bdo> در صورتیکه خطاها موجود باشند رشته ی خالی در صورتیکه فیلد معتبر باشد یک <bdo class="leftInline">&lt;ul class="errorlist"&gt;</bdo> را نمایش می دهد. همچنین می توان با form.message.errors به صورت یک Boolean رفتار کنید و یا حتی درون آن مثل یک لیست جستجو کنید. برای مثال:</p>
<code class="language-django">&lt;div class="field{% if form.message.errors %} errors{% endif %}"&gt;
    {% if form.message.errors %}
        &lt;ul&gt;
        {% for error in form.message.errors %}
            &lt;li&gt;&lt;strong&gt;{{ error }}&lt;/strong&gt;&lt;/li&gt;
        {% endfor %}
        &lt;/ul&gt;
    {% endif %}
    &lt;label for="id_message"&gt;Message:&lt;/label&gt;
    {{ form.message }}
&lt;/div&gt;</code>
</div></main>
<nav class="gradient">
    <div class="titr-link">کتاب های آموزشی</div>
<a title="زبان جاوا" class="anav" href="https://amoozesh.org/java/">زبان جاوا</a><a title="زبان پایتون" class="anav" href="https://amoozesh.org/python/">زبان پایتون</a><a title="فریم ورک جنگو" class="anav" href="https://amoozesh.org/django/">فریمورک جنگو</a><a title="سیستم عامل لینوکس" class="anav" href="https://amoozesh.org/linux/">سیستم عامل لینوکس</a><a title="مطالب CSS" class="anav last-line" href="https://amoozesh.org/css/">مطالب CSS</a><div class="titr-link">کتاب آموزش جنگو</div>
<a href="https://amoozesh.org/django/introduction/" class="anav" title="مقدمه">مقدمه</a><a href="https://amoozesh.org/django/start/" class="anav" title="شروع کار">شروع کار</a><a href="https://amoozesh.org/django/view/urlconf/" class="anav" title="view ها و URLconf ها">view ها و URLconf ها</a><a href="https://amoozesh.org/django/template/" class="anav" title="Template ها">Template ها</a><a href="https://amoozesh.org/django/model/" class="anav" title="مدل ها">مدل ها</a><a href="https://amoozesh.org/django/admin-site/" class="anav" title="سایت مدیر">سایت مدیر</a><div  class="divnav" title="فرم ها">فرم ها</div><a href="https://amoozesh.org/django/view/urlconf/advance/" class="anav" title="View ها و URLconf های پیشرفته">View ها و URLconf های پیشرفته</a><a href="https://amoozesh.org/django/template/advance/" class="anav" title="Template های پیشرفته">Template های پیشرفته</a><a href="https://amoozesh.org/django/model/advance/" class="anav" title="مدل های پیشرفته">مدل های پیشرفته</a><a href="https://amoozesh.org/django/view/generic/" class="anav" title="View های Generic">View های Generic</a><a href="https://amoozesh.org/django/non-html/" class="anav" title="تولید محتوای غیر html ای">تولید محتوای غیر html ای</a><a href="https://amoozesh.org/django/session/" class="anav" title="Session ها، کاربران، و عضویت">Session ها، کاربران، و عضویت</a><a href="https://amoozesh.org/django/caching/" class="anav" title="مبحث Caching">مبحث Caching</a><a href="https://amoozesh.org/django/package/contrib/" class="anav" title="پکیج django.contrib">پکیج django.contrib</a><a href="https://amoozesh.org/django/middleware/" class="anav" title="مبحث Middleware">مبحث Middleware</a><a href="https://amoozesh.org/django/database/integrate/legacy/" class="anav" title="یکپارچه سازی برنامه ها و دیتابیس های Legacy">یکپارچه سازی برنامه ها و دیتابیس های Legacy</a><a href="https://amoozesh.org/django/internationalize/" class="anav" title="بین المللی سازی">بین المللی سازی</a><a href="https://amoozesh.org/django/security/" class="anav" title="امنیت">امنیت</a>    
</nav>
<footer class="gradient">Copyright © 2020 - <a href="https://amoozesh.org/" title="آموزش آنلاین">amoozesh.org</a></footer></body>

</html>